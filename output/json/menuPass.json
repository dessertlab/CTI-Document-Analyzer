[
    {
        "text": "While looking at the other subdomains of kaspresksy[.]com we discovered that:\n27.102.114.246 used to previously resolve from the following domains:\nWe noticed a password-protected zip named \u201cChrome_Updata\u201d being associated with the download[.]kaspresksy[.]com domain. The zip contained a sample of the Poison Ivy malware, which is also known to be used by APT10. The same executable was also seen communicating with 27.102.115.249, which also appeared to be mapped to update[.]kaspresksy[.]com.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All of the overlaps in the network infrastructure make it very reasonable to assume that the same group is operating both variants.\n Both variants of the loader implement the same decryption and injection mechanism.\n Looking at the history of APT10, one can notice major similarities in the details we highlighted in this post:\nSome of the mentioned domain mappings were recently updated. Also, the certificate embedded in the Quasar sample was issued at 22.12.2018, which correlates with the file\u2019s compilation date. This may indicate that these samples are a part of a testing environment or a short-lived attack that is already finished. Either way, it\u2019s safe to say that the threat actor behind APT10 is still active and that we have yet to see the last of the group.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "41542d11abf5bf4a18332e9c4f2c8d1eb5c7e5d4298749b610d86caaa1acb62c (conhost.exe downloader jli.dll)\n 29b0454db88b634656a3fc7c36f318b126a83ae8fb7f73fe9ff349a8f8536c7b (conhost.exe downloader svchost.bin)\n02b95ef7a33a87cc2b3b6fd47db03e711045974e1ecf631d3ba9e076e1e374e9 (PlugX jli.dll)\ne0f91da52fdc61757f6a3f276ae77b01d2d1cc4b3743629c5acbd0341e5de80e (PlugX svchost.bin)\nf13536685206a94a8d3938266f100bb2dffa740a202283c7ea35c58e6dbbb839 (PlugX jli.dll)\nc8d86e9f486d23285b744279812ef9047a0908e39656c2ea4cdf3e182f80e11d (PlugX svchost.bin)\nupdate[.]kaspresksy[.]com\ndownload[.]kaspresksy[.]com\napi[.]kaspresksy[.]com\nffca[.]caibi379[.]com\nupdate[.]microsofts[.]org\nppit[.]microsofts[.]org\ncahe[.]microsofts[.]org\nThe FortiEDR platform is capable of detecting the this threat on both pre-execution and post-execution.  \n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Learn more about FortiGuard Labs threat research and the FortiGuard Security Subscriptions and Services portfolio. Sign up for the weekly Threat Brief from FortiGuard Labs. \n Learn more about Fortinet\u2019s free cybersecurity training initiative or about the Fortinet Network Security Expert program, Network Security Academy program, and FortiVet program.\n",
        "source": "Uncovering New Activity By APT10 _ FortiGuard Labs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During the latter half of 2018, BlackBerry Cylance threat researchers tracked a campaign targeting companies from several verticals across the EMEA region. The campaign seemed to be related to the MenuPass (a.k.a. APT10/Stone Panda/Red Apollo) threat actor, and utilized an open-source backdoor named QuasarRAT to achieve persistence within an organization. We identified several distinct loader variants tailored to specific targets by leveraging machine learning (ML) to analyse our malware corpus. We have not observed new QuasarRAT samples in the wild since late 2018, roughly coinciding with when the FBI indicted several members of the MenuPass group.\n QuasarRAT is a lightweight remote administration tool written in C#.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It can collect system information, download and execute applications, upload files, log keystrokes, grab screenshots/camera captures, retrieve system passwords and run shell commands.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The remote access Trojan (RAT) is loaded by a bespoke loader (a.k.a. DILLWEED). The encrypted QuasarRAT payload is stored in the Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In later variants an additional component is also used to install the RAT as a service (a.k.a DILLJUICE).\n The following technical analysis focuses on the bespoke QuasarRAT loader developed by MenuPass and modifications made to the QuasarRAT backdoor.\n The QuasarRAT loader typically arrives as a 64-bit service DLL.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Its primary purpose is to decrypt, load and invoke an embedded .NET assembly in-memory using the CppHostCLR technique. This technique is based on code snippets from Microsoft DevCentre examples.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The assembly, obfuscated with ConfuserEx, is subsequently responsible for finding, decrypting, and executing a separate malicious .NET module.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "During our investigation we encountered several variants of the loader which indicated a development path lasting over a year; we were also able to locate some (but not all) of the encrypted payload files belonging to these loader variants. After decryption, we discovered that the payloads are backdoors based on the open-source code of QuasarRAT[1], version 2.0.0.0 and 1.3.0.0.\n",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The initial loader binary is a 64-bit PE DLL, intended to run as a service. The DllMain function is empty, while the malicious code is contained in the ServiceMain export. Some variants include an additional randomly named export that creates the malicious service.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In newer versions this functionality was shifted to a standalone module.\n The malware starts by deobfuscating an embedded next-stage executable. In the earliest variant, this is performed using simple XOR with a hardcoded 8-byte key composed of random letters. Later variants use a slightly more advanced XOR based algorithm that requires two single-byte keys.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It\u2019s possible that this approach was implemented to thwart XOR bruteforcing attempts:\nFigure 1: Second stage decryption loop\nStarting with variant 3, the .NET injection mechanism is implemented inside a second stage DLL, which according to debugging strings seems to be part of a project called \u201cAntiLib\u201d:\nFigure 2: Debugging strings from variant 3\nThis DLL is reflectively loaded into memory by an obfuscated shellcode-like routine and invoked by executing an export bearing the unambiguous name: \u201cFuckYouAnti\u201d. Older samples do not contain this second stage library, and the .NET loading functionality is implemented directly in the initial loader:\n Figure 3: FuckYouAnti string in the code and in 2nd stage DLL export table\nOnce executed, the \"FuckYouAnti\" function will decrypt the .NET loader binary using the same XOR based algorithm with a different pair of hardcoded keys.\n To load the assembly directly into memory, the malware makes use of a technique called \"CppHostCLR\" which is described in detail in Microsoft DevCentre. The code looks like the example code provided by Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It invokes the loader entry point using hardcoded class and method names, that are random and differ for each sample:\nFigure 4: Use of CppHostCLR technique\nFigure 5: Invoking .NET assembly loader\nHardcoded .NET version strings and several persistence related strings (in earlier variants) are encrypted using a custom algorithm. This algorithm is based on a single unit T-box implementation of AES-256, combined with 16-byte XOR.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The oldest variant set keys to \u201c1234567890ABCDEF1234567890ABCDEF\u201d and \u201c1234567890ABCDEF\u201d respectively and did not change between samples:\nFigure 6: Example AES and XOR decryption keys\nSamples belonging to variant 3 of the loader present a valid digital signature from CONVENTION DIGITAL LTD (serial number 52 25 B8 E2 2D 3B BC 97 3F DD 24 2F 2C 2E 70 0C) countersigned by Symantec:\nFigure 8: Digital certificate from variant 3\nOnce executed, the malicious assembly will iterate through all files under %WINDOWS%\\Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "NET and attempt to decrypt files matching a specified size. It uses an implementation of RijndaelManaged algorithm in CBC mode:\nIf the decryption succeeds, the malware will attempt to load the decrypted assembly and invoke the specified method:\nThe final payload assembly is stored as an encrypted file somewhere under the Microsoft.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The framework version is hardcoded in the loader binary in an encrypted form, and in most samples set to \u201cv4.0.30319\u201d. The location is different per sample and the file name imitates one of other the legitimate files found in the same directory.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They are similar, both having a version string in their configuration section set to \u201c2.0.0.0\u201d:\nFigure 12. Backdoor assembly in memory (version 2.0.0.0)\nFigure 13. Backdoor assembly in memory (version 1.3.0.0)\nQuasarRAT is an open-source project that proclaims to be designed for legitimate system administration and employee monitoring.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The .NET payload is a heavily obfuscated backdoor based on an open-source remote administration tool called QuasarRAT[3]. The configuration is stored in a class called Settings, with sensitive string values encrypted with AES-128 in CBF mode and base64 encoded. The string\u2019s decryption key is derived from the ENCRYPTIONKEY value inside Settings and is the same for all strings:\nFigure 15.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor modified the original backdoor, adding their own field in the configuration, and code for checking the Internet connectivity. If a valid URL address is specified in the last value of config, the malware will try to download the content of that URL. It will proceed with connecting to the command and control (C2) server only once the download is successful:\n",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The backdoor communicates with the C2 server whose IP address is provided in the HOSTS value of the configuration. All communication is encrypted with AES-128 in CBF mode using KEY and AUTHKEY values from configuration:\nFigure 17. C2 IP address decrypted in memory\nFeatures common for variants 2 and newer:\n",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In fact, our AI-driven security agents demonstrated a predictive advantage[5] of over three years against the majority of current QuasarRAT samples.\n 52 25 B8 E2 2D 3B BC 97 3F DD 24 2F 2C 2E 70 0C\nThe following YARA rule can be used to identify QuasarRAT loaders:\n  rule QuasarRAT_Loader\n  {\n      meta:\n          description = \"MenuPass/APT10 QuasarRAT Loader\"\n      strings:\n          $rdata1 = \" !\\\"#$%&'()*+,-\n./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~\" ascii\n          $rdata2 = \"CONOUT$\" wide\n      condition:\n          // Has MZ header?\n          uint16(0) == 0x5a4d and\n          // File size less than 600KB\n          filesize <",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Contains the following sections (in order)\n          pe.section_index(\".text\") == 0 and\n          pe.section_index(\".rdata\") == 1 and\n          pe.section_index(\".data\") == 2 and\n          pe.section_index(\".pdata\") == 3 and\n          pe.section_index(\".rsrc\") == 4 and\n          pe.section_index(\".reloc\") == 5 and\n          // Has the following export\n          pe.exports(\"ServiceMain\") and\n          // Does not have the following export\n          not pe.exports(\"WUServiceMain\") and\n          // Has the following imports\n          pe.imports(\"advapi32.dll\", \"RegisterServiceCtrlHandlerW\") and\n          // Contains the following strings in .rdata\n          for all of ($rdata*) : ( $ in       \n  (pe.sections[pe.section_index(\".rdata\")].raw_data_offset..pe.sections[pe.section_index\n(\".rdata\")].raw_data_offset+pe.sections[pe.section_index(\".rdata\")].raw_data_size) )\n  }\nThe following YARA rule can be useful for detecting possible high-entropy payloads stored within the %WINDOWS%\\Microsoft. NET\\Framework folder (these files typically have a double file extension): \n  rule Possible_QuasarRAT_Payload\n  {\n      meta:\n          description = \"Possible encrypted QuasarRAT payload\"\n      condition:\n          uint16(0) !",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "0x4947 and \n          math.entropy(0, filesize) > 7.5\n  }\n[1] https://github.com/quasar/QuasarRAT\n[2] https://code.msdn.microsoft.com/windowsdesktop/CppHostCLR-e6581ee0\n [3] https://github.com/quasar/QuasarRAT\n[4] Service installer (a.k.a DILLJUICE)\n [5] https://threatvector.cylance.com/en_us/home/cylance-vs-future-threats-the-predictive-advantage.html\n\u00a9 2023 BlackBerry Limited.",
        "source": "Threat Spotlight_ MenuPass_QuasarRAT Backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u2022 IT and business cloud services managed service provider\n(MSP) and Recorded Future client and supplier, Visma, a\nbillion-dollar Norwegian company with at least 850,000\ncustomers globally\n\u2022 A U.S. law firm with strong experience in intellectual property\nlaw with clients in the pharmaceutical, technology, electronics,\nbiomedical, and automotive sectors, among others\nIn  all  three  incidents,  the  attackers  gained  access  to  networks \nthrough deployments of Citrix and LogMeIn remote-access software \nusing stolen valid user credentials.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers then enumerated \naccess and conducted privilege escalation on the victim networks, \nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 2\nutilizing DLL sideloading techniques documented in a US-CERT alert \non  APT10  to  deliver  malware.    During  the  Visma  intrusion,  APT10 \ndeployed their Trochilus malware with command and control (C2) \ncommunications encrypted using both RC4 and Salsa20 streaming \nciphers rather than the typically observed RC4 variant. On the two \nother victim networks, the attackers deployed a unique version of \nthe UPPERCUT (ANEL) backdoor, known to have only been used by \nAPT10.\n  APT10 actors then compressed proprietary data from Visma using \nWinRAR  (deployed  by  the  attackers)  and  exfiltrated  to  a  Dropbox \naccount using the cURL for Windows command-line tool. The same \nDropbox  account  was  also  accessed  in  a  similar  fashion  by  the \nattackers during the apparel company intrusion. Dropbox was also \nused  to  store  exfiltrated  documents  from  the  third  victim,  a  U.S. \nlaw  firm,  with  the  files  again  exfiltrated  using  identical  TTPs  and \nuploaded using cURL for Windows.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe APT10 is the most significant Chinese state-sponsored \ncyber threat to global corporations known to date.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On top of the \nbreadth, volume, and targets of attacks that APT10 has conducted \nsince at least 2016, we now know that these operations are being \nrun by the Chinese intelligence agency, the Ministry of State Security \n(MSS). \n  Utilizing actors working for shell companies such as Huaying Haitai \nScience and Technology Development Co Ltd (\u5929\u6d25\u534e\u76c8\u6d77\u6cf0\u79d1\u6280\u53d1\u5c55\n\u6709\u9650\u516c\u53f8), and under the direct supervision of their regional bureau \nin  Tianjin,  the  MSS  has  conducted  an  unprecedented  campaign, \ndubbed  \u201cOperation  Cloud  Hopper,\u201d  against  managed  IT  service \nproviders (MSPs) designed to steal intellectual property and enable \nsecondary attacks against their clients. Access to the networks of \nthese  third-party  service  providers  grants  the  MSS  the  ability  to \npotentially  access  the  networks  of  hundreds,  if  not  thousands, \nof  corporations  around  the  world.    We  assess  that  APT10  likely \ncompromised Visma with the primary goal of enabling secondary \nintrusions  onto  their  client  networks,  and  not  of  stealing  Visma \nintellectual property.\n  In this same time frame, APT10 also targeted a U.S. law firm and \nan international apparel company, likely to gather information for \ncommercial  advantage.   ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In  all  three  incidents,  APT10  actors  used \nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 2\npreviously  acquired  legitimate  credentials,  possibly  gained  via  a \nthird-party supply chain compromise in order to gain initial access \nto the law firm and the apparel company.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have identified a new variant of Trochilus malware, with \nits C2 communications encrypted using a combination of RC4 \nand Salsa20 stream ciphers.\n \u2022  An UPPERCUT backdoor was identified in the targeting of \nan international apparel company and U.S. law firm. The \nbackdoor was deployed using the Notepad++ updater and \nsideloading malicious DLL, as noted in APT10\u2019s targeting of \nJapanese corporations in July 2018.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to using Trochilus and UPPERCUT, APT10 utilized a \nseries of previously known and associated attack TTPs for all \nthree of these intrusions.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 3\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 4\n\u2022  Use of DLL sideloading by executing a legitimate \nbinary to load a renamed malicious DLL that decrypts, \ndecompresses, and injects a Trochilus payload into \nmemory\n\u2022  Use of legitimate credentials, possibly acquired through \nprevious MSP compromises, to log in to accessible Citrix \nRemote Desktop clients in targeted organizations\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 4\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 37\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 37\nAPT10 is a threat actor that has been active since at least 2009.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It has \nhistorically targeted healthcare, defense, aerospace, government, \nheavy  industry  and  mining,  and  MSPs  and  IT  services,  as  well  as \nother sectors, for probable intellectual property theft. \n  In  early  2017,  APT10  began  conducting  attacks  against  global \nmanaged  IT  service  providers  (MSPs)  that  granted  them \nunprecedented  access  to  MSPs  and  their  customers\u2019  networks. \n  During  this  operation  (dubbed  \u201c\u2018Cloud  Hopper\u201d  because  of  the \ngroup\u2019s use of popular western cloud-based services), APT10 utilized \nboth new malware (Quasar RAT, Trochilus, RedLeaves, ChChes) as \nwell as some familiar old tools (Poison Ivy, PlugX).\n  Most recently, on December 20, 2018, the U.S. Department of Justice \ncharged two hackers associated with the Chinese Ministry of State \nSecurity (MSS) with global computer intrusion campaigns targeting \nintellectual  property.   ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This  indictment  attributed  the  intrusions  to \nAPT10, a group that had been conducting the malicious activities \nfor  over  a  decade  on  behalf  of  the  MSS,  China\u2019s  civilian  human \nintelligence  agency.    Some  of  the  material  included  within  the \nindictment corroborated information detailed in the Intrusion Truth \nblog that provided strong evidence attributing APT10 to the Tianjin \nState Security Bureau, a provincial bureau of the Ministry of State \nSecurity.    In  the  blog,  Intrusion  Truth  identified  APT10  as  having \nutilized several Tianjin-based companies, including Huaying Haitai \nScience and Technology Development Co. Ltd. and Laoying Baichen \nInstruments Equipment Co. Ltd.\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 5\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 6\nU.S. Department of Justice indictment of APT10 threat actors.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The use of suspected shell companies as a front for MSS-enabled \ncyber activity isn\u2019t a new observation, however.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our research from \n2017  concluded  that  Guangdong  ITSEC  (and  therefore  the  MSS) \ndirected  the  activities  of  a  company  named  Boyusec,  which  was \nidentified as a shell company for APT3.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 8\nOn  August  30,  2018,  APT10  deployed  their  first  modified  version \nof  Trochilus  that  had  its  C2  communications  encrypted  using \nSalsa20 and RC4-encrypted Trochilus variant seen in the wild.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This \nsample, similar to other Trochilus samples, was deployed using a \nDLL sideloading method utilizing three files, uploaded to the same \nfolder on the victim machine as identified in US-CERT advisory TA17-\n117A (last revised on December 20, 2018). This method involves the \nuse of a legitimate binary (File 1) used to load a malicious DLL (File \n2).",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malicious DLL is renamed to match the name of an expected \nDLL to be loaded by the executable.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malicious DLL then decrypts \nand decompresses shellcode contained within a third file placed by \nthe attackers in the same temporary folder.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The configuration file \nthen loads the Trochilus payload into memory by injecting it into a \nvalid system process.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers used Mimikatz (pd.exe) to enable credential theft and \nmade  use  of  scheduled  tasks  via  the  Microsoft  BITSAdmin  utility \nto transfer files from their C2 to the Visma network. The attackers \npreferred to upload their malicious tooling to the C:\\ProgramData\\\ntemp or C:\\ProgramData\\media directories and executed commands \nusing batch files (x.bat).",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A full list of the filenames of the suspected \nattacker tooling can be found in the report appendices.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In order to exfiltrate the compromised data, the attackers employed \ncustom  malware  that  used  Dropbox  as  its  C2.   They  also  used \nWinRAR and cURL for Windows, both often renamed, to compress \nand  upload  the  exfiltrated  files  from  the  Visma  network  to  the \nDropbox API. \n Our  research  partner  Rapid7  investigated  the  Dropbox  use  and \nfound  that  the  attackers  had  used  the  same  account  to  store \nexfiltrated data from a global apparel company. They also identified \nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 8\nJapanese forum post within a dark web community asking if anyone speaks an Asian language.\n broadly similar TTPs being used in the attack against a U.S. law firm \nspecializing in intellectual property law. The firm has a dedicated \nChina practice aimed at assisting Chinese companies entering the \nU.S. market.\n Rapid7\u2019s  investigation  revealed  the  law  firm  was  first  targeted  in \nlate  2017,  followed  by  the  apparel  company  a  few  months  later, \nand finally, the Visma attack in August 2018.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In one of the attacks, \nRapid7 identified the attackers escaping a Citrix application in order \nto run the payload script on the victim desktop.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Interestingly, in all \nthree attacks, the targeting of Citrix remote desktops was a common \nthread.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 9\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 10\nVPN Consumer Network is an ambiguous Panama-registered entity. \n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on information in WHOIS registration records, the website for \nthe company is vpnconsumer.com, which is a nondescript landing \npage only containing the abuse contact details and a physical address \nin  Panama.    BGP  routing  information  shows  that  the  organization \nmanages 44/24 subnets hosted around the world, many of which \nresolve to low-cost VPN services, such as ExpressVPN.\n  Insikt  Group  analysis  of  network  metadata  to  and  from  the  VPN \nendpoint  IPs  revealed  consistent  connectivity  to  Citrix-hosted \ninfrastructure from all eight VPN endpoint IPs starting on August \n17, 2018 \u2014 the same date the first authenticated login to Visma\u2019s \nnetwork was made using stolen credentials.\n  After  almost  two  weeks,  on  August  30,  2018,  APT10  attackers \nused their access to the network to move laterally and made their \nfirst deployment of an RC4- and Salsa20-encrypted variant of the \nTrochilus  malware  using  a  previously  associated  DLL  sideloading \ntechnique.    Two  separate  infection  chains  leveraging  this  specific \nDLL  sideloading  technique  were  identified  on  the  Visma  network \nusing  legitimate  known  good  binaries  that  had  DLL  search-order \npath issues.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once  on  the  Visma  network,  APT10  attackers  used  the  Microsoft \nBITSAdmin  CLI  tool  to  copy  malicious  tools  from  a  suspected \nattacker-controlled  C2  hosted  on  173.254.236[.]158  to  the  \\\nProgramData\\temp\\ directory on the infected host.    \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 10\n\u2022  A legitimate binary for the uninstaller for PDF printing \napplication PDF-Xchange 2011 Lite DE, renamed from \nunins000.exe to CASTSP.exe (f6e0f076e27391a6e6eb23f23f77c \n2ff078488875113df388640aca8bf4dd64b)\n\u2022   An accompanying malicious DLL, version.dll (10182f0e64b765 \ndb989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3)\n\u2022  A DES-encrypted shellcode configuration containing the \nTrochilus implant into the same folder (42b5eb1f77a25ad73 \n202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6)\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After the files were copied across the attacker-executed CASTSP.exe, \nthis file sideloaded and ran version.dll, which in turn decrypted and \ndecompressed the encrypted shellcode and injected the Trochilus \npayload into memory.\n Legitimate binary for \nPDF-Xchange 2011 Lite DE \nuninstaller, unins000.exe, \nrenamed to CASTSP.exe \nby attackers\nversion.dll decrypts \nshellcode and injects \nTrochilus payload \ninto memory\nTrochilus variant deployed \nin memory, with C2 \ncommunications encrypted \nusing XOR, RC4, and Salsa20\nInfection Chain 2: September 4, 2018\n A  few  days  later,  APT10  used  an  almost  identical  approach  used \nduring  Infection  Chain  1  to  deploy  Trochilus  onto  another  part \nof  Visma\u2019s  network.   While  the  deployed  DLL  and  the  encrypted \nshellcode  were  named  differently,  the  underlying  method \nof  malware  installation  was  the  same  as  Infection  Chain  1.  \n The  files  remotely  copied  into  C:\\ProgramData\\temp\\  using  \nBITSAdmin included:\n\u2022  Another dropper renamed to \u201cCASTSP.exe\u201d that this time \nwas a legitimately signed Microsoft Visual Studio binary \nTailoredDeploy.Host.exe (also known as TailoredDeploy.exe)\n(fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22 \n167e1d402a1514) \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 11\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 12\n\u2022  A malicious DLL, vcruntime140.dll (eed0c7f7d36e75382c83 \nThe  execution  method  was  identical:  CASTSP.exe  sideloaded  and \nran  vcruntime140.dll,  which  decrypted  and  decompressed  the \nencrypted  shellcode  configuration  and  injected  the  Trochilus \npayload into a system process in-memory on the host machine.\nvcruntime140.dll \ndecrypts shellcode and \ninjects Trochilus \npayload into memory\nTrochilus variant \ndeployed in memory, with \nC2 communications \nencrypted using XOR, \nRC4, and Salsa20\nLegitimate binary for \nMicrosoft Visual Studio, \nTailoredDeploy.Host.exe, \nrenamed to CASTSP.exe \nby attackers\nThe malware sets used for both infection chains are nearly identical \nboth in infection method and code structure. Because the malware \nfor  both  infection  chains  were  so  similar,  it  is  only  necessary  to \ninclude the in-depth analysis for one chain here, so we focused on \nInfection Chain 1. It included the binaries below:\n\u2022  CASTSP.exe: A valid and signed application that utilizes DLL \nsideloading to execute the malicious DLL, \u201cversion.dll\u201d\n\u2022  Version.dll: Main functionality of \u201cVersion.dll\u201d is to decrypt and \nThe  Trochilus  loader,  version.dll,  has  four  entry  points,  as \nshown  below.   The  malicious  entrypoint  called  by  CASTSP.exe  is \nDllEntryPoint.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 12\nAfter  version.dll  runs,  it  loads  the  file  CZYSOYKPOIKKZGUFOIUI \ninto memory. The file \u201cCZYSOYKPOIKKZGUFOIUI\u201d is 387,094 bytes \nof binary code that is not human-readable. \n After the file is loaded, the next function, sub_6a351000, starts the \ndecryption  routine  for  CZYSOYKPOIKKZGUFOIUI.   The  file  is  DES-\nencrypted and the key can be identified being loaded into memory \nat the start of the decryption routine.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 13\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 14\nOnce  the  payload  is  decrypted,  version.dll  creates  a  new  process \nin  a  suspended  state  and  writes  the  Trochilus  payload  into  the \nsuspended  process.   Next,  version.dll  resumes  the  process, \nexecuting the Trochilus payload.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The C2 infrastructure, network communications, \nand  encryption  are  different  from  prior  versions,  but  the  code \nsimilarities and the use of DLL sideloading demonstrate that this \nis  just  another  variant  of  Trochilus.   First,  the  libraries  below  are \nincluded in the Trochilus variant and are known to be a part of the \nsource code upon which Trochilus is based on.\n Second, the unencrypted C2 beacon, _msgid.23.__serial.0.clientid.\nxxxxxxxxxxxxxxx,  is  a  well-defined  component  of  the  Trochilus \nsource code.\n The capabilities of Trochilus are well documented in other research \nreports, but the C2 infrastructure for this variant uses a combination \nof XOR, RC4, and Salsa20, which is different from what has previously \nbeen reported for Trochilus.\n The C2 domain www.miphomanager[.]com is hardcoded, and after \na successful DNS request for the IP address, the Trochilus implant \nwill use that IP address for communication.\n1  https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.carbonblack.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 15\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 16\nThe  encoding  and  encryption  routines  used  in  this  variant  are \ndifferent from other variants and use three stages of encryption. \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The rolling XOR key \nis computed by taking two initial values, Constant 1 and Constant \n2, and adding them together.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The result is then divided against the \ndivisor 0xff. The remainder of this result is used as the XOR key.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "On \nthe second iteration, Constant 1 is now saved as Constant 2, and \nConstant 2 becomes the remainder from the previous operation. \n They  are  added  together  and  again  divided  by  the  divisor  0xff  to \nproduce  the  next  XOR  key.   This  process  repeats  until  the  end  of \nthe cleartext string. A Python script is provided below showing this \nencoding function.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our analysis revealed that the \u201c__msgid.23.\u201d cleartext string below \nwas sent to the XOR function above. \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The  resulting  data  then  goes  to  the  second  stage,  which  is  RC4 \nencryption  using  the  hard-coded  string  NASDKJF7832Hnkjsadf87 \n8UHds89iujkhNHKJDHJDH8UIYE98uihwjshewde8w. The main  \nroutine shown below takes the key and then sends it to the function \nsub_B49252,  which  initializes  the  key-scheduling  algorithm  (KSA) \nand  pseudo-random  generation  algorithm  (PRGA),  which  are  the \ntwo key components of RC4 encryption.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 17\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 18\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For the final phase, the resulting data from the RC4 encryption is \nthen  encrypted  again,  this  time  with  Salsa20.   Salsa20  is  another \nstream cipher that encrypts data in 64-byte blocks. Salsa20 uses a \nsecret key and nonce to initialize the encryption.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 18\nAfter the message is encrypted, it is then sent via an HTTP POST to \nthe C2 host, which in this case is the domain www.miphomanager",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 19\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 20\nDNS log data revealed that requests were made for the malicious \nTrochilus C2 domain, www.miphomanager[.]com, as early as August \n30, 2018 \u2014 only two weeks after Visma was initially compromised \non August 17, 2018. This slight delay may point to the handing over \nof  active  exploitation  duties  to  other  operator(s)  in  a  multi-team \nAPT10 effort within the Ministry of State Security for the attack. \n According  to  WHOIS  information,  the  malicious  \"miphomanager\" \ndomain  was  registered  with  a  relatively  small  Bahamas-based \ndomain registrar, internet.bs.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This registrar is widely noted to host \na disproportionate number of rogue or malicious websites, with the \nregistrar aggressively marketing itself as an \u201coffshore\u201d registrar.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Other \nexamples  of  malicious  infrastructure  registered  with  internet.bs  \ninclude domains for APT28\u2019s VPNFilter malware campaign and the \nregistration  of  the  cyber-berkut[.]org  domain  that  was  affiliated \nwith  the  pro-Russian  and  potentially  Russian  state-linked  threat \nactor CyberBerkut. \n The registrant organization name was privacy protected using Whois \nPrivacy Corp, and the registered name servers for the malicious C2 \nwere listed as:\nInternet.bs  and  the  name  servers  listed  above  were  noted  in  the \nregistration of a malicious C2 used in a KHRAT campaign targeting \nCambodia. KHRAT is a backdoor trojan purported to be used with \nthe China-linked cyberespionage group DragonOK.\n All three name servers appear in Recorded Future with an unusual \nrisk  rating  as  they  appear  in  the  \u201cBambenek  Consulting  C&C \nNameserver  Blocklist\u201d  threat  list,  because  of  their  prevalence  in \nbeing associated with a Zeus-based banking trojan, Sphinx. \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 20\nDuring  our  investigation,  we  also  found  evidence  of  a  legitimate \ndecompression  utility  typically  packaged  with  Java  named \n\u201cunpack200.exe\u201d being executed on the Visma network. This utility \nsideloaded  Mimikatz  (pd.exe)  and  enabled  credential  theft  from \nVisma  users.   Interestingly,  the  same  combination  of  unpack200.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "exe to deploy Mimikatz was used by the same attackers in both the \napparel company and U.S.-based law firm breaches. \n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Using the newly acquired credentials, the attacker accessed Visma\u2019s \nMicrosoft Active Directory domain controller, deployed Trochilus, \nand made a copy of the \u201cNTDS.DIT\u201d database file containing Active \nDirectory data for Visma\u2019s corporate network, including password \nhashes for all users in the domain.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The NTDS.DIT file and accompanying stolen data was then packaged \nup using a renamed WinRAR executable (r.exe) that was transferred \nacross by the attacker who then used cURL for Windows (renamed \nto  \u201cCU.exe\u201d)  to  upload  the  exfil  to  content.dropboxapi.com.    The \nRAR files followed a naming convention of a short run of repeating \ncharacters  (for  example,  kkk.rar,  ss.rar,  pp.rar,  dds.rar,  gggg.rar, \netc).\n  Rapid7 research revealed the exfiltrated content from Visma was \nuploaded to a Dropbox account that contained files from another \nincident  related  to  the  compromise  of  an  international  apparel \ncompany that they were investigating.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once inside the victim network, the attacker deployed \ntheir own customized malware and also used known good binaries \nthat have DLL search order hijacking issues in order to perform DLL \nsideloading  to  execute  customized  versions  of  Mimikatz  in  order \nto retrieve passwords. The filename for the custom malware was \n\u201cccSEUPDT.exe\u201d  (MD5:  d8e37f07fdc9827871f0f959519275e1),  a \nlegitimate  Symantec  Security  Submission  Engine  Update  Module \nbinary.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The custom malware also would have a DLL in the same staging \nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 21\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 22\ndirectory and a randomized 15-character uppercase and lowercase \nalpha character set filename without an extension that contained the \nshellcode.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker used unpack200.exe (MD5: 6807be8466955b \nafffa568b6da0e785c),  a  decompression  program \nthat \ncomes  with  Java  8  and  their  copy  of  Mimikatz  was  placed \n(MD5:  c8ea12ee884f274ca35fa54a073 \ninto  MSVCR100.DLL \ndf130).\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These methods of initial ingress into the victim networks and the \nmethod of obtaining passwords remained consistent TTPs across \nall  victims.   ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The  DLL  sideloading  technique  can  evade  application \nwhitelisting and antivirus software. However, if deployed, systems \nthat  perform  process.start  creation  would  log  the  command  line \nbeing  passed  to  the  binary  and  could  be  reviewed,  and  then \nsignatures created that look for the common flags could be passed \nto Mimikatz.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker would also move laterally by mounting the \nremote drive on a system, copying \u201c1.bat\u201d to it, use task scheduler \nto execute, and then delete the batch script.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In order to perform exfiltration of the stolen data, the attacker used \ncommon  file  compression  utilities  (rar.exe)  to  create  archives  of \nthe information they intended to exfiltrate, and then used common \ncommand  line-based  web  clients  (curl.exe)  to  transfer  the  stolen \ndata to a cloud-based storage provider (Dropbox).",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To  maintain  access  to  the  victim  network  from  the  external \npublic  internet,  the  attacker  deployed  password-protected \n\u201ciisstart.aspx,\u201d   SHA256: \nASP  eval  webshells \n243d47fc2a24b391e1153d5c7807c6e5de51aba65fc79465d7b3e \n5c64d5fac41)  within  the  client  environment  in  order  to  maintain \naccess.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This resembled the server-side ASPX payload of the China Chopper \nwebshell  documented  previously.   Uploads  to  VirusTotal  in  late \nAugust 2018 resembling the same filename, iisstart.aspx, indicate \nthe  deployed  webshell  was  likely  a  version  of  the  China  Chopper \nwebshell known to have been used by several Chinese threat actors.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 22\nThe  attacker  also  used  TeamViewer  in  order  to  maintain  remote \naccess to compromised systems within the victim environment.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In early 2018, Rapid7 identified that the attackers compromised an \napparel company, based upon detections and intelligence gathered \nfrom the U.S.-based law firm breach.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attacker gained access to \nthe victim\u2019s internet-accessible Citrix systems and authenticated to \nthem from networks associated with low-cost VPN providers owned \nby  VPN  Consumer  Network.   ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Rapid7  again  observed  the  attackers \ndropping  payloads  named  \u201cccSEUPDT.exe.\u201d    The  attackers  used \nidentical  TTPs  for  executing  malware  and  Mimikatz  as  observed \nbefore, by using DLL sideloading with known good binaries that had \nDLL  search  order  path  issues.    The  attackers  used  the  Notepad++ \nupdater  GUP.exe  (MD5:  f5322b2f18605674b9a0c1757de5fd94), \nJava  archive  decompression  utility  unpack200.exe \nthe \nr e n a m e d \n( M D 5 :   6 8 0 7 b e 8 4 6 6 9 5 5 b a f f f a 5 6 8 b 6 d a 0 e 7 8 5 c ) ,  \nfrom  \u201ccoInst.exe,\u201d  and  Norton  Identity  Safe  binary  CASRTSP.\n ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "(MD5:  1e3a57cff7cba8732364c26f4bbdcbe2).    These \nexe \nbinaries  were  used \nfiles \nMSVCR100.DLL  (MD5:  5739c1f17503e21e56667d53ea823401) \na n d  \n( M D 5 :   8 f 0 7 1 6 0",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "f e b d b 2 4 0 9 0 9 b 2 7 a a 5 1 9 b \nba575).  ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Rapid7  reviewed  malware  discovered  in  the  victim\u2019s \nenvironment  and  found  implants  that  used  Dropbox  as  the  C2. \n The  attackers  used  the  same  method  of  lateral  movement  by \nmounting the remote drive on a system, copying 1.bat to it, using \ntask scheduler to execute the batch script, and finally, deleting the \nbatch script.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "d l l  \nFor  exfiltration  of  stolen  data,  the  attacker  used  WinRAR  and \nrenamed \u201crar.exe\u201d to \u201cr.exe\u201d to create archives, upload them with \n\u201ccurl.exe\u201d  (renamed  to  \u201cc.exe\u201d),  and  again,  use  the  cloud  storage \nprovider  Dropbox.   Rapid7  discovered  that  additional  data  was \nplaced  into  the  Dropbox  accounts  under  control  of  the  attacker \nduring  the  compromise  and  was  able  to  attribute  data  that  was \nplaced  into  it  as  being  owned  by  Visma.   Rapid7  then  provided  a \nbreach  notification  to  Visma  to  alert  them  to  this  compromise  in \nSeptember 2018.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 23\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 24\nWe  identified  three  victims  of  cyberespionage  operations  since \nlate 2017 across the managed IT service provider, retail, and legal \nsectors.   The  targeted  sectors  vary  significantly,  indicating  a  wide \nscope of targeting for the group. We assess with high confidence \nthat the attacks were conducted by Chinese MSS threat actor APT10, \nbased on the evidence outlined in this report, summarized below:\n1.  ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While the  \n variant has not been noted publicly previously, Trochilus \n is widely used by APT10.\n2.  ",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The use of legitimate binaries to sideload malicious DLLs  \n that decrypt and decompress shellcode configuration files  \n containing a Trochilus payload.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The use of Notepad++ updater (filename \u201cgup.exe\u201d) to load  \n malicious DLL (libcurl.dll) in the deployment of the APT10  \n backdoor, UPPERCUT.\n 4.  Extensive use of command-line tools including, but not  \n limited to, Mimikatz, cURL for Windows, BITSAdmin, and  \n WinRAR, to perform actions on-host.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The targeting of a Norwegian MSP, which enabled potential  \n access to an extensive customer base. We believe that the  \n APT10 targeting of Visma is an extension of their 2017 Cloud  \n Hopper operation (which victimized some of the world\u2019s  \n largest MSPs) and has continued into late 2018. \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The unauthorized access to Citrix remote desktop clients at  \n Visma using stolen credentials occured at times  \n corresponding to Tianjin working hours (GMT +8). \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We  believe  APT10  is  the  most  significant  known  Chinese \nstate-sponsored  cyber  threat  to  global  corporations.   Their \nunprecedented  campaign  against  MSPs,  alleged  to  have \nincluded  some  of  the  largest  MSPs  in  the  world,  in  order  to \nconduct  secondary  attacks  against  their  clients,  grants  the \nChinese  state  the  ability  to  potentially  access  the  networks  of \nhundreds  (if  not  thousands)  of  corporations  around  the  world. \n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future recommends organizations conduct the following \nmeasures  outlined  in  this  section  in  conjunction  with  the  advice \npublished by US-CERT2 and the U.K.\u2019s NCSC3 when defending against \nAPT10 attempts to gain network access.\n  \u2022  Configure your intrusion detection systems (IDS), intrusion \nprevention systems (IPS), or any network defense mechanisms \nin place to alert on \u2014 and upon review, consider blocking \nillicit connection attempts from \u2014 the external IP addresses \nand domains listed in Appendix A.\n2  https://www.us-cert.gov/ncas/alerts/TA17-117A, https://www.us-cert.gov/APTs-Targeting-\nIT-Service-Provider-Customers, https://www.us-cert.gov/ncas/alerts/TA18-276B \n3  https://www.ncsc.gov.uk/content/files/protected_files/article_files/APT10%20alert%20\nv2_0.pdf\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 26\n\u2022  Implement the provided SNORT rules in Appendix B into your \nIDS and IPS appliance and investigate any alerts generated for \nactivity resembling the TTPs outlined in this report on APT10. \n\u2022  Conduct regular Yara scans across your enterprise for the new \nrules listed in Appendix C and those listed in the official U.S. \nand U.K. government advisories listed above.\n  \u2022  Consider blocking any connection attempts emanating from \nIPs resolving to \u201cVPN Consumer Network\u201d (listed in Appendix \nB) and consider implementing a VPN whitelisting policy based \non approved vendors. \n  \u2022  Detection of potential ASP eval webshells can be difficult, but \ncan be accomplished by deploying file integrity monitoring \nof the web root directories on all servers with a client \nenvironment.\n  \u2022  Detection of exfiltration based on network flow data would be \ndifficult if the attacker chose to use the same cloud storage \nprovider that the victim has standardized upon. However, if \nSSL is proxied for monitoring, signatures can be created to \nidentify this activity by checking the user agent or method \nof client header construction against the Dropbox client \napplications themselves.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If so, consider detecting, alerting, and blocking \nrequests for the nameservers below associated with the \ndisproportionately malicious domain registrar internet.bs:\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 26\nAppendix A \u2014 Indicators of Compromise\nIPv4\n173.254.236[.]158\n104.237.86[.]157\n104.237.86[.]183\n173.239.198[.]167\n45.56.155[.]117\n45.56.155[.]143\n45.56.155[.]147\n45.62.52[.]42\n  45.62.52[.]7\n45.76.30[.]127\nHashes\nMD5: C8ea12ee884f274ca35fa54a073df130 - MSVCR100.dll\nMD5: 8f07160febdb240909b27aa519bba575 - libcurl.dll\nSHA256: 42b5eb1f77a25ad73202d3be14e1833ef0502b0b6ae7ab54f5d4b5c2283429c6 - CZYSOYKPOIKKZGUFOIUI (Infection \nChain 1)\n SHA256: F6e0f076e27391a6e6eb23f23f77c2ff078488875113df388640aca8bf4dd64b - CASTSP.exe (Infection Chain 1)\nSHA256: 10182f0e64b765db989c158402c76eb1e0e862cab407f7c5cec133d8e5cb73e3 - version.dll (Infection Chain 1)\nSHA256: Fc6a130504b54fa72cfc104c656fe2cd92d7998f42ca064e22167e1d402a1514 - CASTSP.exe (Infection Chain 2)\n SHA256: E6280de09f9adf79212409529eb25c0c2ea73e33a50281e22228a3db3998eecb - RUTLFJPBTJSFZZAOJTYP (Infection Chain \n2)\nSHA256: Eed0c7f7d36e75382c83e945a8b00abf01d3762b973c952dec05ceccb34b487d - vcruntime140.dll (Infection Chain 2)\nSHA256: ad116485f9184c85fd28331edae629c41fc39ec5123f41b15f6507b139a883c1 - unpack200.exe\nSHA256: C77535e19e5655f6ef72de3b2318e580095ca396c4383287cf8b5d4896235756 - gup.exe\nSHA256: Bfeb6efee4891de135431091079e659631376953a46065f7e44335df10d16425 - CASRTSP.exe (renamed from coInst.exe)\nSHA256: 5c5618e680bc45654dd55f161f195afbac98a7e111e4ef536ed811656582168d - MSVCR100.dll\nFilenames\nat.exe\nat.exe.cfg\nC.bat\nCU.EXE\nlg.exe\nps.exe\nr.exe\nat.exe \nCU.EXE \n1.bat \nat.exe.cfg \nC.bat.cfg \ndd.dmp \ndds.rar \nlg.exe \nlg.exe.cfg \nns.exe \nns.exe.cfg\npd.exe\nsam.save\nss.rar\nvcruntime140.dll\nversion.dll\nunpack200.exe\nCASTSP.exe\nRUTLFJPBTJSFZZAOJTYP\nCZYSOYKPOIKKZGUFOIUI\nLibcurl.dll\nMsvcr100.dll\nGup.exe\nCASRTSP.exe\nRecorded Future | www.recordedfuture.com",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 28\nRedLeaves Snort Rules sourced from US-CERT alert TA17-117A\nalert tcp any any -> any any (msg: \u201cREDLEAVES Implant\u201d; content: \u201c|00 00 7a 8d 9b dc|\u201d; offset: \n2; depth: 6; content: \u201c|00 00|\u201d; offset: 10; depth: 2; sid:",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 30\nrule YARA_CN_APT10_UPPERCUT_libcurl_injector {\n   meta:\n      description = \u201cMalicious DLL libcurl.dll launched using benign GUP.exe to inject UPPERCUT payload by APT10 in 2018 \ncampaign\u201d\n      author = \u201cInsikt Group, Recorded Future\u201d\n      tlp = \u201cwhite\u201d\n      date = \u201c2019-01-16\u201d\n      hash1 = \u201c465c4e72580f62a340e0555afc857a79ad8b9d86de228efe3627f26690cc45f7\u201d\n   strings:\n      $s1 = \u201chemas.microsoft.com/SMI/2005/WindowsSettings\\\u201d>true</dpiAware></windowsSettings></application></\nassembly>\u201d fullword ascii\n      $s2 = \u201ccurity><requestedPrivileges><requestedExecutionLevel level=\\\u201dasInvoker\\\u201d uiAccess=\\\u201dfalse\\\u201d></\nrequestedExecutionLevel></requeste\u201d ascii\n      $s3 = \u201cGUP.exe\u201d fullword ascii\n      $s4 = \u201cwinsta0\\\\Winlogon\u201d fullword ascii\n      $s5 = \u201coperator co_await\u201d fullword ascii\n      $s6 = \u201c: :$:(:,:0:4:@:D:H:L:P:T:X:\\\\:\u201d fullword ascii\n      $s7 = \u201cqwertyuiop\u201d fullword ascii\n      $s8 = \u201c5j5$7(7,7074787<7@7D7H7L7P7T7X7\\\\7`7d7h7l7p7t7x7|7\u201d fullword ascii\n      $s9 = \u201c<assembly xmlns=\\\u201durn:schemas-microsoft-com:asm.v1\\\u201d manifestVersion=\\\u201d1.0\\\u201d><trustInfo \nxmlns=\\\u201durn:schemas-microsoft-com:asm.v3\u201d ascii\n      $s10 = \u201cCNSEOJAN286\u201d fullword ascii\n      $s11 = \u201cvileges></security></trustInfo><application xmlns=\\\u201durn: schemas-microsoft-com:asm.\nv3\\\u201d><windowsSettings><dpiAware xmlns=\\\u201dhttp:/\u201d ascii\n      $s12 = \u201cvLUkkDvRzmLFNWZ\u201d fullword ascii\n   condition:\n      uint16(0) == 0x5a4d and filesize < 400KB and\n      ( pe.imphash() == \u201c1c6aa1b4dfcf6a901b9a00dc3fbbd5a9\u201d or 8 of them )\n}\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 30\nPE32 executable for MS Windows (GUI) Intel 80386 32-bit\nLegitimate PDF-XChange uninstaller. A valid and signed application that utilizes \nDLL sideloading to execute the malicious DLL, \u201cVersion.dll.\u201d\nPE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit\nMalicious DLL, sideloaded using legitimate binary to decrypt, decompress, and \ninject DES-encrypted malicious Trochilus payload into memory.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 31\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 32\nPE32 executable for MS Windows (GUI) Intel 80386 32-bit\nLegitimate Microsoft Visual Studio 6.0 binary.",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When executed on host device, \nsideloads  colocated  malicious  DLL  to  kickstart  injection  of  malicious  payload \nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 32\nWin32 DLL; PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit\nMalicious DLL, sideloaded using legitimate binary to decrypt, decompress, and \ninject DES-encrypted malicious Trochilus payload into memory.\n Server-side component of China Chopper ASPX payload. \n Recorded Future | www.recordedfuture.com | CTA-2019-0206 | 33\nRecorded Future | www.recordedfuture.com | CTA-2019-0206 | 34\nAppendix E \u2014 MITRE ATT&CK Mapping\nThe MITRE ATT&CK grid populated below identifies the techniques \nutilized by APT10 attackers in the targeting outlined in this research.\n Exfiltration Over Command \nand Control Channel\nSigned Script Proxy Execution Logon Scripts\nRegistry Run Keys / Startup \nFolder\nTechniques observed in this campaign and noted as previously used by APT10  \nNew techniques observed in this campaign not previously noted as used  \nTechniques not observed during this campaign previously used by APT10\nHighlighted  with  green  are  the  new  techniques  used  by  APT10 \nidentified during this campaign.\n In  yellow  are  the  techniques  that  were  observed  during  this \ncampaign and had previously been associated with APT10.\n In blue are techniques used by APT10 in previous campaigns that \nweren\u2019t observed in this campaign.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "| CTA-2019-0206 | 34\nAll  timelines  and  methods  are  documented  in  this  report  from \nRecorded Future and Rapid7.\n Visma\u2019s  intelligence  systems  gave  them  warning  about  the  theft \n(a  threat  hunter  from  Rapid7  used  the  Visma  Global  Responsible \nDisclosure  Policy).   Visma  correlated  the  intelligence  from  Rapid7 \nagainst  their  internal  alerts  and  mitigated  the  threat.   They  soon \nconfirmed that none of their clients\u2019 systems were affected.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The  Visma  Corporate  Security  Incident  Response  Team  (Visma \nCSIRT) worked closely with their Product Security Operations Center \n(PSOC), NSM NorCERT, as well as the police.\n After initial attribution (using data from Recorded Future, among \nother  systems),  Visma  decided  to  contract  an  external  partner \n(Recorded Future) to dig deeper into the incident report and gather \nadditional  intelligence  in  order  to  ensure  proper  attribution  to \nbetter understand this threat actor.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this case, no client data was compromised, and Visma chose not \nto issue a general alert before they had conclusive evidence on who \nperformed the theft.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They  assisted  NSM  NorCERT  and  others  in  the  investigation  and \ngeneral cleanup of this case.\n",
        "source": "cta-2019-0206.pdf",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In August 2019, Proofpoint researchers reported that LookBack malware was targeting the United States (U.S.) utilities sector between July and August 2019. We then continued our analysis into additional LookBack campaigns that unfolded between August 21-29, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These campaigns utilized malicious macro-laden documents in order to deliver modular malware to targeted utility providers across the U.S. At the same time as the LookBack campaigns, Proofpoint researchers identified a new, additional malware family named FlowCloud that was also being delivered to U.S. utilities providers.\n FlowCloud malware, like LookBack, gives attackers complete control over a compromised system. Its remote access trojan (RAT) functionality includes the ability to access installed applications, the keyboard, mouse, screen, files, services, and processes with the ability to exfiltrate information via command and control.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We analyzed phishing campaigns between July-November 2019 and have determined that both LookBack and FlowCloud malware can be attributed to a single threat actor we are calling TA410. This conclusion is based on the threat actor\u2019s use of shared attachment macros, malware installation techniques, and overlapping delivery infrastructure.\n In addition, our analysis found similarities between TA410 and TA429 (APT10) delivery tactics.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "TA410 campaigns detected in November 2019 included TA429 (APT10)-related infrastructure used in phishing attachment delivery macros.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, Proofpoint analysts believe that intentional reuse of well-publicized TA429 (APT10) techniques and infrastructure may be an attempt by threat actors to create a false flag. For this reason, while research is ongoing, we do not attribute LookBack and FlowCloud campaigns to TA429 (APT10). Proofpoint currently tracks TA429 (APT10) independently of TA410 campaigns.\n Figure 1 below shows a timeline of the identified LookBack and FlowCloud campaigns.\n Figure 1 LookBack and FlowCloud Campaign Timeline\nProofpoint researchers observed phishing campaigns beginning on July 10, 2019 that targeted utility providers across the United States with portable executable (PE) attachments and used subject lines such as \u201cPowerSafe energy educational courses (30-days trial)\u201d.  ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our analysis of these phishing campaigns determined that the PE attachments delivered a modular malware which the developers referred to in program data base (\u201cPDB\u201d) paths as \u201cFlowCloud\u201d. We therefore refer to these campaigns as \u201cFlowCloud\u201d based on the malware family they delivered. It\u2019s notable that these FlowCloud campaigns were occurring at the same time as the LookBack campaigns that Proofpoint has previously documented.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In some cases, both FlowCloud and LookBack campaigns targeted not only the same companies but also the same recipients.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The senders of the emails that delivered FlowCloud malware utilized threat actor-controlled domains for delivery which impersonated energy sector training services, as well as utilized subdomains which contained the word \u201cengineer\u201d.\n We observed a distinct change in FlowCloud delivery tactics beginning with attacks carried out in November 2019. The targeting of US utilities companies remained constant, but the threat actors shifted from PE attachments to malicious macro laden Microsoft Word documents that closely resembled the same delivery and installation macros used in LookBack malware campaigns.\n Additionally, in November threat actors began to utilize the sender domain asce[.]email to deliver these attachments.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This domain was first observed in June 2019 registered to the IP 103.253.41[.]75 which was used as a staging and reconnaissance IP in previous LookBack campaigns. On October 29, 2019, the domain resolved to the IP 134.209.99[.]169 which also hosted several energy certification and education themed domains. A number of these domains also shared an SSL certificate with delivery domains previously observed in the July and August 2019 FlowCloud phishing campaigns. The data from this SSL Certificate has been displayed in Figure 2.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This figure demonstrates the actor\u2019s use of a single SSL certificate for multiple energy and training themed domains. The actor listed the domains that were signed by the certificate in the Alternative Names field allowing for the identification of additional related infrastructure. A number of these domains were used in FlowCloud campaigns.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The table below shows the TA410 staging IPs, when they were first observed, the registered domains associated with them, and the malware delivered by emails originating from these domains.\n The content of the emails in the November 2019 campaigns impersonated the American Society of Civil Engineers and masqueraded as the legitimate domain asce[.]org. The structure of this email is very similar to the LookBack delivery emails constructed to impersonate the NCEES and Global Energy Certification in July 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Examples of the emails are included in Figure 3 and Figure 4.\nFigure 3 ASCE-themed phishing email delivering FlowCloud malware November 2019\nFigure 4 NCEES-themed phishing email delivering LookBack malware July 2019\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As noted above, after an extended period of using PE attachments to deliver FlowCloud in campaigns, the threat actors behind FlowCloud switched to using Microsoft Word documents with malicious macros at the beginning of November 2019. The Word document attachments and macros delivering FlowCloud had key similarities with the Word document attachments and macros we identified that delivered LookBack in July and August 2019.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Identical to the methodology used with LookBack, the FlowCloud macro used privacy enhanced mail (\u201c.pem\u201d)  files which were subsequently renamed to the text file \u201cpense1.txt\u201d. This file is next saved as a portable executable file named \u201cgup.exe\u201d and executed using a version of the certutil.exe tool named \u201cTemptcm.tmp\u201d.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For comparison, Figure 5 November 2019 macro used to install FlowCloud malware shows the macro used to install FlowCloud while Figure 6 August 2019 macro used to install LookBack malware shows the macro used to install LookBack.\n  Figure 5 November 2019 macro used to install FlowCloud malware\nFigure 6 August 2019 macro used to install LookBack malware\nThe \u201cExploitation\u201d section in our blog  LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards has a more in-depth explanation of this method used by LookBack.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While we found the ultimate execution method for both the LookBack Gup proxy tool and FlowCloud malware were the same across both macro versions, we found that the FlowCloud macro introduced a new method for the delivery of the malware.\n  The earlier LookBack versions of the macro included the payload in numerous privacy enhanced email (\u201c.pem\u201d) files that were dropped when the attachment file is executed by the user.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The FlowCloud version of the macro utilized a previously unobserved macro section to download the payload from a DropBox URL.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the payload was downloaded, a FlowCloud malware PE in the form of a .pem file was saved as the variable \u201cPense1.txt\u201d.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 7 FlowCloud Malware Macro delivery code shows the FlowCloud macro with the delivery section in question called out.\n Figure 7 FlowCloud Malware Macro delivery code\nThe FlowCloud macro also contained a strange try\u2026 catch statement which initially attempts to download the FlowCloud payload from the DropBox URL as part of the try statement. However, if it was unable to retrieve the payload from that resource, a catch statement which was nearly identical to the try statement attempted to retrieve a malware resource from the URL http://ffca.caibi379[.]com/rwjh/qtinfo.txt\u201d.\u201d.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 8 FlowCloud Malware Catch statement macro code shows the catch statement in question.\n Figure 8 FlowCloud Malware Catch statement macro code\nThis try\u2026catch sequence is significant because the URL in the catch statement and malware resource was previously mentioned in a May 2019 blog by enSilo entitled \u201cUncovering New Activity by APT10\u201d. The blog claims that this URL delivered a modified Quasar RAT payload which included the addition of SharpSploit, an opensource post-exploitation tool. When analyzed on the same date of FlowCloud campaign delivery this URL and resource was unavailable, while the DropBox URL successfully delivered the FlowCloud .pem file. While Proofpoint has not independently verified these attribution claims made by other researchers regarding the referenced Quasar RAT sample, the use of this URL represents a previously undisclosed overlap with publicly reported indicators of compromise attributed to TA429 (APT10). While on the surface this domain may imply links to TA429 (APT10), we have identified several aberrations regarding the domain registration information and inactive nature of the URL and will discuss them at length at length later in this blog.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our analysis of the FlowCloud malware determined that it is a multi-stage payload comprised of a large code base written in C++.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The code demonstrates a level of complexity including numerous components, extensive object-oriented programming, and use of legitimate and imitation QQ files for initial and later stage execution. We found further imitation of QQ components in several modules used throughout FlowCloud execution. The malware name \u201cFlowCloud\u201d was taken from distinctive PDB paths observed in numerous malware components. These values have been included in the IOCs section at the end of this blog.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FlowCloud malware is capable of RAT functionalities based on its available commands including accessing the clipboard, installed applications, keyboard, mouse, screen, files, services, and processes with the ability to exfiltrate information via command and control.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, the malware variants analyzed have several distinct characteristics that indicate the malware may have been active in the threat landscape since at least July 2016.\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to components built to target updated Windows versions, FlowCloud samples have dropped a 32-bit module that was only compatible with Windows versions 6 (Windows Vista) and below.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The dated nature of this binary coupled with the extensible nature of the malware code suggests that the FlowCloud code base has been under development for numerous years. Public reports around FlowCloud malware components and related installation directory paths suggest that versions of this malware may have been observed in the wild as early as July 2016. Additionally, development of this malware around legitimate QQ files and the identification of malware samples uploaded to VirusTotal from Japan in December 2018 and earlier this year from Taiwan indicate that the malware may have been active for some time in Asia prior to its appearance targeting the US utilities sector.\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 9 Flowchart of FlowCloud Loader Functionality below outlines FlowCloud\u2019s loader functionality.\n  Figure 9 Flowchart of FlowCloud Loader Functionality\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware stores its configuration in the registry alongside drivers utilized by the malware\u2019s keylogger components.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Several additional distinct registry keys are generated which indicate the malware\u2019s current execution stage on the host.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some of these keys are included in the table below.\n The FlowCloud loader component EhStorAuthn.exe stores the malware configuration in the registry early in the installation chain and is represented in the table above.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Registry data is composed of multiple encrypted headers (using XORs and RORs) and data is encrypted using a modified (or broken) AES algorithm. The plaintext data is compressed with ZLIB and serialized using Google\u2019s Protocol Buffers. \ufffcFigure 10 shows an example of a configuration as displayed by FlowCloud\u2019s debug logging:\nFigure 10 Example of a configuration as displayed by debug logging\nFlowCloud malware handles configuration updates, file exfiltration, and commands as independent threads utilizing a custom binary C2 protocol. We identified these independent threads as part of an extensive command handling functionality with distinct command managers existing for each command. The sample we analyzed utilized port 55555 for file exfiltration and port 55556 for all other data. We identified FlowCloud communication with the IP 188.131.233[.]27.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The requests and responses are composed of multiple encrypted headers (using XORs and RORs) and TEA encrypted data using a key generation scheme involving a hardcoded string of random characters and MD5 hashing.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "An example parsing of an initial beacon is demonstrated in Figure 11 Example of FlowCloud parsing an initial C2 beacon:\nFigure 11 Example of FlowCloud parsing an initial C2 beacon\nComparing Public TA429 (APT10) Indicators with TA410 Campaigns\nPublications by FireEye and EnSilo regarding TA429 (APT10) campaigns contain indicators that later appeared in TA410 campaigns. In our retrospective analysis of that research, we determined that TA429 (APT10) used phishing macros that were later seen being used by LookBack and FlowCloud malware. Additionally, we identified the Quasar RAT delivery URL hxxp://ffca.caibi379[.]com/rwjh/qtinfo.txt used by FlowCloud macros in November, which was published in the enSilo report prior to observable weaponization for TA410 campaigns.\n  Interestingly, the compilation date of several LookBack malware modules used in July 2019 were September 14, 2018.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This includes the SodomMain and SodomNormal modules covered in previous Proofpoint blogs on LookBack malware.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "That date is just one day after FireEye released their initial analysis of similar TA429 (APT10) macros utilized in Japan on September 13, 2018.\n  While LookBack malware samples were not observed in the wild until June 2019, this September 2018 compilation date demonstrates a large lag time between compilation and delivery.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This possibly suggests manipulation of compilation times by threat actors but has not been conclusively determined.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Most of the domain registration (weaponization) for LookBack and FlowCloud campaigns began in May and June 2019 respectively.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, enSilo\u2019s publication on potentially TA429 (APT10) related Quasar RAT samples was published on May 24, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It was not until the second week of November 2019 when the inactive URL was incorporated into a phishing macro as part of a FlowCloud campaign targeting US utilities.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "WHOIS records and passive DNS information for ffca.caibi379[.]com indicate that the registrant email and address fields for the domain were updated on June 7, 2019.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The A record for the domain was updated on September 9, 2019 at which time it resolved to the IP 34.80.27[.]200 contained within an ASN owned by Google. For the prior eight months beginning on January 2, 2019 and encompassing the period of activity discussed by enSilo, the domain was hosted on several IP\u2019s in an ASN owned by APNIC Hostmaster.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shift away from IP infrastructure owned by APNIC represents a departure in threat actor infrastructure hosting tactics well after the publication by enSilo and within the weaponization period for TA410\u2019s campaign targeting US utilities.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While this research is not conclusive, it demonstrates that all observed TA429 (APT10) similarities and indicators of compromise were available publicly prior to the start of TA410 campaigns.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Therefore, while not conclusive from current analysis, the possibility remains that these overlaps represent false flag activity by the TA410 threat actor.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Based on this analysis Proofpoint analysts track TA410 as a distinct threat actor from TA429 (APT10) at this time.\n ",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The convergence of LookBack and FlowCloud malware campaigns in November 2019 demonstrates the capabilities of TA410 actors to distinctly utilize multiple tools as part of a single ongoing campaign against US utilities providers. Both malware families demonstrate a level of sophistication in their conception and development while the extensible code base of FlowCloud malware suggests that this group may have been operating as early as 2016.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "TA410 operators demonstrate a willingness to dynamically evolve phishing tactics to increase the effectiveness of their campaigns and a keen eye towards plausible social engineering within a very select targeted sector.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It remains unclear if the nature of the tactics and indicators that are shared with TA429 (APT10) were developed by this group or culled from readily available technical reporting that pre-dated these campaigns.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The possibility remains that these overlaps represent intentional false flag efforts to cloak the identity of these perpetrators while they targeted a critical and geo-politically sensitive sector of energy providers in the US.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Regardless of the actor\u2019s intention, TA410 has established itself as a motivated actor with mature toolsets carrying out long term campaigns against highly important and geographically concentrated target sets.\n",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "PE Attachment - our infrastructure offer ann\u00c3\u00a2\u00c2\u20ac\u00c2\u00aecod.exe\nPE Attachment - powersafe courses ann\u00c3\u00a2\u00c2\u20ac\u00c2\u00aecod.exe\nFlowCloud MS Word Macro Attachment - personal invitation.doc\n2837783 ETPRO TROJAN Win32/LookBack CnC Activity\n\u00a9 2023.",
        "source": "TA410_ Malware Attacks Against U.S. Utilities Sector _ Proofpoint US.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since around October 2016, JPCERT/CC has been confirming information leakage and other damages caused by malware \u2018RedLeaves\u2019.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is a new type of malware which has been observed since 2016 in attachments to targeted emails.\n This entry introduces details of RedLeaves and results of our analysis including its relation to PlugX, and a tool which is used as the base of this malware.\n To have the RedLeaves injected into the process of Internet Explorer, the following steps will be taken (Figure1):\nMalware samples that JPCERT/CC has analysed create the following three files in %TEMP% folder and execute a legitimate application when executed.\n When the legitimate application is executed, it loads the loader located in the same folder through DLL Hijacking (DLL preloading).\n The loader, which is loaded in the legitimate application, reads and decodes the encoded RedLeaves and then executes it. The executed RedLeaves launches a process (Internet Explorer) depending on its configuration, and injects itself there.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Then, RedLeaves starts running in the injected process. The following section explains the behaviour of the injected RedLeaves.\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "RedLeaves communicates to specific sites by HTTP or its custom protocol and executes commands that are received.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The injected RedLeaves connects to command and control (C&C) servers by HTTP POST request or its custom protocol. Destination hosts and communication methods are specified in its configuration.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The data is encrypted with RC4 (the key is stored in its configuration) and contains the following:\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The data received from the C&C servers contain commands. Depending on the received commands, RedLeaves executes the following functions (Please see Table B-3 in Appendix B for the details of received data):\nJPCERT/CC analysed RedLeaves and confirmed that its code has a lot in common with the source code of Trochilus[1], a type of RAT (Remote Administration Tool), which is available on Github. Figure 3 shows part of the code to process received data.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is clear that it processes the same data as listed in Table B-3 in Appendix B.\nIt is presumed that RedLeaves is built on top of Trochilus\u2019s source code, rather than from scratch.\n Comparing RedLeaves samples that JPCERT/CC has observed with PlugX, used by certain attacker groups in the past, we identified that similar code is used in some processes. Below are the sequence of instructions observed when the sample creates three files (a legitimate application, a loader and encoded RedLeaves or PlugX).\n Furthermore, the process in which the loader decodes the encoded data (encoded RedLeaves or PlugX) is similar.\n JPCERT/CC has also confirmed that some of the RedLeaves and PlugX samples that share the above code also communicate with common hosts. From this observation, it is presumed that the attacker group using RedLeaves may have used PlugX before.\n",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "RedLeaves is a new type of malware being observed since 2016 in attachments to targeted emails.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The hash values of the samples introduced here are listed in Appendix C. Some of the RedLeaves\u2019 destination hosts that JPCERT/CC has confirmed are also listed in Appendix D. Please check your devices for any suspicious communication with such hosts.\n [1] Trochilus: A fast&free windows remote administration Tool\nSince December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks. Prior to joining JPCERT/CC, he was engaged in security monitoring and analysis operations at a foreign-affiliated IT vendor.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n This form is for comments and inquiries.",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "MalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nYAMA-Yet Another Memory Analyzer for malware detection\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\nGobRAT malware written in Go language targeting Linux routers\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nHow to Use Volatility 3 Offline",
        "source": "RedLeaves - Malware Based on Open Source RAT - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At the beginning of April, Carbon Black Threat Research began analyzing a malware variant commonly referred to as Red Leaves, which appears to have code reuse from the PlugX family. During the last month, this malware family has been referenced in several security blogs and government alerts.\n Carbon Black is publicly providing this technical write up to assist customers, other organizations, and researchers continuing to investigate incidents related to this malware family. Along with this report, Carbon Black is providing product specific queries, rules and scripts aimed at assisting in the detection and analysis of this malware family in the Carbon Black User Exchange. The overall process of how the malware\u2019s components are created on an infected system and the different points where the suite of Carbon Black products could detect the different stages of the malware are outlined in that User Exchange post.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware uses a technique called DLL side loading, which is common with the PlugX family. DLL sideloading works by using a legitimate or benign executable file to load a modified DLL. This DLL is responsible for loading and executing an encoded or encrypted malicious data file.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The ultimate payload for this sample is a shellcode loader, which injects the Red Leaves implant, via process hollowing, into a hard coded process.\n The metadata for the initial dropper file that was analyzed is listed in the information below.\n The initial stage of the sample analyzed has little functionality outside of dropping or creating the malicious second stage files on the infected system. PlugX has in the past been documented as being delivered via a self extracting (SFX) Rar executable, which acts as the first stage dropper.\n Once the files have been created on disk, the dropper will execute the Obedience.exe file, starting the overall process. A brief overview of the entire process is outlined in the below two figures and the accompanying table.\n The first stage dropper will push several hard-coded values to a function, which is responsible for decoding the three embedded files. These files comprise the second stage of the overall malware setup.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The image below displays these values being pushed (highlighted in red) as well as being labeled for clarity.\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The pushed values in the above image (file offsets and sizes), are passed to a function responsible for decoding and writing the files to disk, along with the hard coded file names.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The function will decode the first half of the file with one set of XOR keys (these instructions are highlighted in red), and the second half of the function with a different set of XOR keys (these instructions are highlighted in yellow).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The XOR key sets are derived from a 16 byte ASCII string immediately preceding the encoded data, in which every other byte is used to XOR each byte of encoded data.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first eight bytes are used for the first half of the file and the last 8 bytes for the second half of the file.\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To clarify this process, the data in the table below represents one of the encoded embedded files.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first 16 bytes (which are in bold) are the ASCII string, from which the key sets are derived.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first half of the file is decoded by XORing each byte of encoded data with each byte which is designated in red below. The second half is of the file is then decoded in the same manner using the each byte, in blue, from the second half of the overall string. The same result can be obtained by XORing each byte of the 4 byte key and then using the result to XOR each byte of encoded data, which in this specific scenario is 0x1B and clearly visible from the null areas of an executable file.\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The file labeled as embed_1 is a legitimate and validly signed executable (typically used in conjunction with different CD software applications), and in this sample will be created as the hard coded name obedience.exe (it should be noted that the file name could easily be changed in other variants).\n  The file labeled as embed_2 is a slightly modified file that will be named StarBurn.dll.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The final file labeled as embed_3 is an encoded file that when decoded and executed will inject the Red Leaves implant into the memory of a target process.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "All of these files will be be created in the current user\u2019s Temp folder (ex. C:Users[account]AppDataLocalTemp). The first stage dropper is also responsible for installing the persistence mechanism for the malware, as a shortcut named persuasion.lnk in the current user\u2019s startup folder. The shortcut or link file will point to the target file obedience.exe and will execute that file when the user logs into the system.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the benign file obedience.exe has been executed it loads several libraries, one of which is StarBurn.dll.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The below image displays the Import table from Obedience showing where the malicious GetVersion function is imported. The StarBurn.dll is side loaded, which is a fairly common tactic often associated with the PlugX family.\n Once the GetVersion function from StarBurn.dll is imported it will execute and look for the hard coded filename handkerchief.dat in the directory where StarBurn.dll is located.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The pseudo-code in the image below highlights the the next steps in the process (variables were renamed for clarity).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The StarBurn.dll function will make the address space where the handkerchief.dat data was read into memory read, write and executable (which is highlighted in the first red box).\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The function will then decode the data in the same manner in which the previous embedded files were decoded, where a 16 byte ASCII string is used to derive 2 XOR key sets, which are then used to decode the first and second half of the files.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The StarBurn.dll function will then create a thread with the starting address of the decoded data, is highlighted in the second red box.\n ",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The table below is a small excerpt of the decoded shellcode, which will load the Red Leaves implant into memory.\n  The shellcode will load several common libraries which will be used to inject the Red Leaves payload into memory.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shellcode decodes (using a single byte XOR of 0x53) a portion of the implant\u2019s configuration block, where the processname is stored that will be injected into via process hollowing.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The shellcode loader will then create a process in suspended state, in this case the target process was Iexplore.exe.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The image below, which has been commented for clarity, displays where the shellcode creates the suspended thread.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Red Leaves payload will then be written to that process\u2019 memory location and the thread is then resumed allowing the Red Leaves implant to impersonate Internet Explorer and communicate with the pre-configure C2s.\n As other research reports have pointed the embedded Red Leaves implant has the MZ and PE ASCII characters from the DOS and PE headers overwritten with the values 0xFF, which are highlighted in red in the table below.\n Once the Red Leaves malware is running the program will initially decode its configuration block, which is encoded using a single byte XOR (in this example the 0x53).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The configuration block is 0x940 bytes in length and contains several different options related to how the malware will install itself as well as where and how it will communicate with the hard coded C2s. The configuration block itself is a list of null terminated strings and binary values, which correspond to hard coded values.\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The configuration block is detailed in the table below. The Value section are the values present in the sample that was analyzed.\n After the configuration data has been decoded the malware will go into the main communication thread creation function, which is responsible for initiating the communications to the embedded C2s. The connection mode value is evaluated and the malware will used the appropriate functions to either use a custom protocol or standard APIs to communicate with the C2s.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The value in this sample is 4 which will then attempt to resolve the different C2s iterating through the ports 443, 53, 80, and 995 (in that specific order).\n",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once a connection has been established the malware will communicate with the C2 utilizing the RC4 algorithm with the key \u201cLucky123\u201d. The malware uses a series of command Identifiers, which are parsed, and then the program will pass control to the appropriate functions to carry out commands and return the responses or data back to the C2.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The jump table responsible for evaluating commands is displayed in the image below.\n The communication protocol has been well documented in other research papers, which can be reviewed for further information.",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The malware itself has the following capabilities, which allow the malware to be used as an efficient Remote Access Tool (RAT).",
        "source": "Carbon Black Threat Research Dissects Red Leaves Malware, Which Leverages DLL Side Loading - VMware Security Blog - VMware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Since around October 2016, JPCERT/CC has been confirming emails that are sent to Japanese organisations with a ZIP file attachment containing executable files. The targeted emails, which impersonate existing persons, are sent from free email address services available in Japan. Also, the executable files\u2019 icons are disguised as Word documents. When the recipient executes the file, the machine is infected with malware called ChChes.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While some ZIP files attached to the targeted emails in this campaign contain executable files only, in some cases they also contain dummy Word documents.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Below is the example of the latter case.\n In the above example, two files with similar names are listed: a dummy Word document and an executable file whose icon is disguised as a Word document. By running this executable file, the machine will be infected with ChChes. JPCERT/CC has confirmed the executable files that have signatures of a specific code signing certificate. The dummy Word document is harmless, and its contents are existing online articles related to the file name \u201cWhy Donald Trump won\u201d. The details of the code signing certificate is described in Appendix A.\nChChes is a type of malware that communicates with specific sites using HTTP to receive commands and modules.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This means it expands its functions by receiving modules from C&C servers and loading them on the memory.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As you can see, the path for HTTP request takes /[random string].htm, however, the value for the Cookie field is not random but encrypted strings corresponding to actual data used in the communication with C&C servers.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The value can be decrypted using the below Python script.\n The following is the flow of communication after the machine is infected.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The value in the Cookie field of the HTTP request that ChChes first sends (Request 1) contains encrypted data starting with \u2018A\u2019.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following is an example of data sent.\n As indicated in Figure 3, the data which is sent contains information including computer name. The format of the encrypted data differs depending on ChChes\u2019s version. The details are specified in Appendix B.\nAs a response to Request 1, ChChes receives strings of an ID identifying the infected machine from C&C servers (Response 1).",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At this point, the following data starting with \u2018B\u2019 is encrypted and contained in the Cookie field.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As a response to Request 2, encrypted modules and commands (Response 2) are sent from C&C servers. The following shows an example of received modules and commands after decryption.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Commands are sent either together with modules as a single data (as above), or by itself.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Afterwards, execution results of the received command are sent to C&C servers, and it returns to the process to receive modules and commands.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This way, by repeatedly receiving commands from C&C servers, the infected machines will be controlled remotely.\n JPCERT/CC\u2019s research has confirmed modules with the following functions, which are thought to be the bot function of ChChes.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Especially, it was confirmed that the module that encrypts the communication with AES is received in a relatively early stage after the infection. With this feature, communication with C&C servers after this point will be encrypted in AES on top of the existing encryption method.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ChChes is a relatively new kind of malware which has been seen since around October 2016.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As this may be continually used for targeted attacks, JPCERT/CC will keep an eye on ChChes and attack activities using the malware.\n The hash values of the samples demonstrated here are described in Appendix C. The malware\u2019s destination hosts that JPCERT/CC has confirmed are listed in Appendix D. We recommend that you check if your machines are communicating with such hosts.\n The code signing certificate attached to some samples are the following:\nThe graph below shows the relation between the version numbers of the ChChes samples that JPCERT/CC has confirmed and the compile times obtained from their PE headers.\n The lists below describe encrypted data contained in the first HTTP request and explanation of the values for each ChChes version.\n Please use the below contact form for any inquiries about the article.\n",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n This form is for comments and inquiries.",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "MalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nYAMA-Yet Another Memory Analyzer for malware detection\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\nGobRAT malware written in Go language targeting Linux routers\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nHow to Use Volatility 3 Offline",
        "source": "ChChes \u2013 Malware that Communicates with C&C Servers Using Cookie Headers - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In April 2017, a previously unknown group calling itself IntrusionTruth began releasing blog posts detailing individuals believed to be associated with major Chinese intrusion campaigns.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although the group\u2019s exact motives remain unclear, its initial tranche of information exposed individuals connected to long-running GOTHIC PANDA (APT3) operations, culminating in a connection to the Chinese firm Boyusec (\u535a\u5fa1\u4fe1\u606f) and, ultimately, Chinese Ministry of State Security (MSS) entities in Guangzhou.\n  Recently, in July and August 2018, IntrusionTruth has returned with new reporting regarding actors with ties to historic STONE PANDA (APT10) activity and has ultimately associated them with the MSS Tianjin Bureau (\u5929\u6d25\u5e02\u56fd\u5bb6\u5b89\u5168\u5c40).",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Though CrowdStrike\u00ae Falcon Intelligence\u2122 is currently unable to confirm all of the details provided in these most recent posts with a high degree of confidence, several key pieces of information can be verified.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "More details that may further illuminate these findings and provide a higher confidence in connecting STONE PANDA to the MSS Tianjin Bureau are likely to emerge.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Throughout May 2017, using a variety of historical information and open-source intelligence (OSINT), IntrusionTruth released several blog posts identifying several individuals connected to Boyusec. Though CrowdStrike\u2019s Threat Intelligence team had suspected GOTHIC PANDA was an MSS contractor for several years, the IntrusionTruth posts and subsequent research by RecordedFuture into MSS ties to the China Information Technology Evaluation Center (CNITSEC/\u4e2d\u56fd\u4fe1\u606f\u5b89\u5168\u6d4b\u8bc4\u4e2d\u5fc3) corroborated additional details from various sources and provided a higher degree of confidence. Confidence in these findings was further boosted when the U.S. Department of Justice named Boyusec and several of the described individuals in an indictment, and detailed GOTHIC PANDA tactics, techniques, and procedures (TTPs) in detail.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "CrowdStrike Falcon\u00ae Intelligence was able to independently verify the majority of this information and concluded that not only is CNITSEC associated with the MSS, but its former director WU Shizhong (\u5434\u4e16\u5fe0) was simultaneously dual-hatted as the director of the MSS Technology/13th Bureau (\u56fd\u5bb6\u5b89\u5168\u90e8\u79d1\u6280\u5c40\u5c40\u957f)1 2 3, implying that the MSS plays a crucial role in China\u2019s code review of foreign products and is now able to cherry pick high-value vulnerabilities from its own capable domestic bug hunting teams. CNITSEC\u2019s role in code review for foreign entities has led to its access to Microsoft\u2019s source code dating back to 2003 and the use by KRYPTONITE PANDA of a high-value vulnerability (CVE-2018-0802), discovered by Chinese firm Qihoo 360, a month before it was publicly revealed.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "WU Shizhong Presenting on the \u201cDigital Silk Road\u201d at the Second Wuzhen World Internet Conference in 2015\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As research into the IntrusionTruth leads on STONE PANDA continues, Falcon Intelligence has already observed some consistencies with known MSS operations.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Many of the personal details for GAO were scrubbed shortly after IntrusionTruth\u2019s post introducing him went live, including his\nTencent QQ account.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The blog connects him to the moniker fisherxp via an initial spear-phishing campaign from 2010 previously attributed to STONE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Multiple sites with profile pictures appear to show the owner of the fisherxp accounts, though this has yet to be independently confirmed as GAO.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Fisherxp\u2019s QQ shows his alternate username as \u80a5\u732a or \u201cbig porker\u201d. IntrusionTruth later links GAO to several documented Uber rides to the MSS Tianjin Bureau\u2019s office address where both his first name, Qiang/\u5f3a, and \u732a are used by the app to identify him and tie him to the QQ number 420192. CrowdStrike cannot confirm the validity of these Uber receipts at this time.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, fisherxp\u2019s account on popular Chinese technology forum 51CTO is still active and shows that he has downloaded not only the open-source DarkComet RAT and numerous password cracking tools, but more importantly, several favorite tools used by a plethora of known Chinese cyber adversaries including Gh0st RAT 3.6, zxarps (an ARP-spoofing tool by legacy hacker LZX), and lcx.exe (a port-forwarding tool by legacy hacker LCX)4.\n ZHANG was originally introduced by IntrusionTruth as a reciprocal follower of fisherxp\u2019s Twitter account via his own @baobeilong account. Baobeilong (\u5b9d\u8d1d\u9f99/\u201dBaby Dragon\u201d) also maintained a GitHub account that had forked both the Quasar\nand Trochilus RATs, two open-source tools historically used by STONE PANDA, but the account has since been scrubbed.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information was verified by CrowdStrike before being removed completely. Falcon Intelligence recently independently conducted detailed analysis of the RedLeaves malware used to target numerous Japanese defense groups and found it was directly sourced from Trochilus code, but it has undergone several evolutions and contains prefixes suggesting it could also be used to target Russia and the DPRK. There is no conclusive evidence at this time that RedLeaves is solely attributed to STONE PANDA.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Baobeilong did maintain a Flickr account with numerous pictures that proved key in identifying his location later, similar to how cpyy\u2019s photos helped identify his affiliation to the People\u2019s Liberation Army (PLA) in CrowdStrike\u2019s PUTTER PANDA report.\n  IntrusionTruth then drew connections from baobeilong\u2019s other online accounts to registrant details for xiaohong[.]org, which dated back to 2007 and revealed ZHANG\u2019s full name\u2014ZHANG Shilong. From there, a trail of overlapping registrant details reveals ZHANG\u2019s hanzi characters for his name (\u5f20\u4e16\u9f99), likely one of his personal home addresses, potential work addresses and several email addresses:\nSpecifically tracing registrant details from atreexp \u2192 robin4700 \u2192 eshilong shows that ZHANG was active registering sites as recently as June 5, 2018, including a personal blog where his picture and name features prominently along with several technology-related blog posts.  \n  A picture from baobeilong\u2019s Flickr account shows a fire at the Tianjin Medical Center 120\nThe original blog post on GAO lists his contact information in recruitment postings for two separate companies, one of which is Laoying Baichen Instruments (characters unknown at the time of this writing).",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "No records could be found for such a firm, however, IntrusionTruth lists the address associated with it as Room 1102, Guanfu Mansion, 46 Xinkai Road, Hedong District, Tianjin (\u5929\u6d25\u5e02\u6cb3\u4e1c\u533a\u65b0\u5f00\u8def46\u53f7\u51a0\u798f\u5927\u53a61102).\n  During the course of investigating Laoying and the Guanfu mansion, Falcon Intelligence noticed that the Guanfu Mansion is also the registered address of a firm called Tianjin Henglide Technology Co., Ltd. (\u6052\u5229\u5fb7\u5929\u6d25\u79d1\u6280\u6709\u9650\u516c\u53f8), which is listed as one of only a few \u201creview centers\u201d certified by CNITSEC in Tianjin5.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Laoying and Henglide are listed as being on different floors, however having a CNITSEC review center in the same building is noteworthy given CNITSEC\u2019s connection to MSS and previous linkage to Boyusec/GOTHIC PANDA.\n ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Zhang is believed to have taken the photo of the fire from the Wanchan Meizhuan Mansion.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is relatively close to both the Yuyang Complex (one of Zhang\u2019s listed registrant addresses) and the Guanfu Mansion, Laoying Baichen\u2019s listed address.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As the IntrusionTruth blog post mentions, it is a registered firm with two listed representatives, Fang Ting (\u65b9\u4ead) and Sun Lei (\u5b59\u6770), and a listed address of 1906 Fuyu Mansion (\u5929\u6d25\u5e02\u6cb3\u897f\u533a\u89e3\u653e\u5357\u8def\u4e2d\u6bb5\u897f\u4fa7\u5bcc\u88d5\u5927\u53a61-1906).\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One is a recruitment Excel sheet detailing recent graduates, their majors and their new employers and addresses.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Huaying Haitai is listed as having hired a recently graduated female student from Nankai University in 2013 who majored in Japanese. This is interesting considering STONE PANDA\u2019s extensive targeting of Japanese defense firms after this time period, but it is by no means conclusive evidence that the firm is connected to STONE PANDA.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The second government document lists Huaying Haitai as the co-organizer of a Network Security Attack and Defense competition with the Ministry of Industry and Information Technology\u2019s (MIIT) national training entity, NSACE6.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "NSACE appears to be a national education body that teaches network information security, including offensive activity7.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This information is particularly interesting given Boyusec\u2019s previous work at CNITSEC\u2019s Guangdong subsidiary setting up a joint active defense lab8.  ",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It suggests that these technology firms act as both shell companies and recruitment grounds for potential MSS use in cyber operations.\n The most recent IntrusionTruth post assesses that GAO\u2019s Uber rides frequently took him from Huaying\u2019s address at the Fuyu Mansion to 85 Zhujiang Road (\u73e0\u6c5f\u905385\u53f7).\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When observed closely, the compound is a striking one complete with towers, a fenced perimeter with surveillance cameras, guarded entrances, and a building with a significant number of satellite dishes.\n There are no markers on the building and no government listed address; however, it is apparently difficult for locals to determine where the Tianjin Bureau\u2019s location is as well.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There are several Baidu questions asking what transportation routes are best to get to that specific address.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Three separate ones specifically mention the 85 Zhujiang Road address as the headquarters for the MSS\u2019s Tianjin Bureau and the difficulty in finding its location9 10 11.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As with most cyber-enabled operations, satellite arrays are often indicative of installations with significant signals intelligence (SIGINT) capabilities.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Tianjin Bureau appears to have the potential for such capabilities, housing several large arrays that appear to have existed since at least January 2004.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Barely visible satellite dishes from the street view of 85 Zhujiang Road outside the compound\nThere are still significant intelligence gaps that prevent Falcon Intelligence from making an assessment about STONE PANDA\u2019s potential connections to the MSS Tianjin Bureau with a high degree of confidence. However, additional information is likely to materialize either directly from IntrusionTruth or from other firms in the infosec community who are undoubtedly looking at this material as well and may have unique insight of their own. Ultimately, IntrusionTruth\u2019s prior releases on GOTHIC PANDA proved accurate and led to a U.S. Department of Justice indictment resulting in the dismantling of Boyusec. From their latest post, which contains GAO\u2019s Uber receipts, it is clear the group\u2019s information likely goes beyond merely available OSINT data.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It cannot be ignored that there are striking similarities between the entities associated with GOTHIC PANDA and the actors and firms mentioned in the blogs about STONE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition, FalconIntelligence notes that following the late 2015 Sino-U.S. brief cyber detente, much of the responsibility for western cyber intrusion operations was handed to the MSS as the PLA underwent an extensive reform that is still currently underway, and which is consolidating its military cyber forces under the Strategic Support Force.\n Though the detente saw an initial drop in Chinese intrusion activity, it has steadily been increasing over the past several years, with a majority of the intrusions into western firms being conducted by suspected contractors.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These adversaries are tracked by CrowdStrike as GOTHIC PANDA, STONE PANDA, WICKED PANDA, JUDGMENT PANDA, and KRYPTONITE PANDA.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Many of these adversaries have begun targeting supply chain and upstream providers to establish a potential platform for future operations and enable the collection of larger sets of data.\n While the APT1, PUTTER PANDA, and Operation CameraShy reports all exposed PLA units at a time when Chinese military hacking against western firms was rampant, the attention has now swung toward identifying MSS contractors. The exposure of STONE PANDA as an MSS contractor would be another blow to China\u2019s current cyber operations given STONE PANDA\u2019s prolific targeting of a variety of sectors, and may prompt an additional U.S. investigation at a tenuous time for Sino-U.S. relations during an ongoing trade war.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, it is important to note that such public revelations often force these actors to cease operations, improve their operational security (OPSEC), and then return stronger than before. As such, CrowdStrike Falcon\u00ae Intelligence assesses that although Boyusec may have shuttered, elements of GOTHIC PANDA are likely to still be active.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The same is likely to be true for STONE PANDA following a period of silence.   \n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The activities of STONE PANDA impact entities in the Aerospace & Defense, Government,  Healthcare, Technology,  Telecommunications Services of several nations.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For more information on how to incorporate intelligence on threat actors like STONE PANDA into your security strategy, please visit the Falcon Intelligence product page.\n",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Detect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection.",
        "source": "Two Birds, One STONE PANDA.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT10 (MenuPass Group) is a Chinese cyber espionage group that FireEye has tracked since 2009.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They have historically targeted construction and engineering, aerospace, and telecom firms, and governments in the United States, Europe, and Japan.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe that the targeting of these industries has been in support of Chinese national security goals, including acquiring valuable military and intelligence information as well as the theft of confidential business data to support Chinese corporations.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group was initially detected targeting a Japanese university, and more widespread targeting in Japan was subsequently uncovered.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Further collaboration between FireEye as a Service (FaaS), Mandiant and FireEye iSIGHT intelligence uncovered additional victims worldwide, a new suite of tools and novel techniques.\nLeveraging its global footprint, FireEye has detected APT10 activity across six continents in 2016 and 2017. APT10 has targeted or compromised manufacturing companies in India, Japan and Northern Europe; a mining company in South America; and multiple IT service providers worldwide.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We believe these companies are a mix of final targets and organizations that could provide a foothold in a final target.\n",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to the continued use of SOGU, the current wave of intrusions has involved new tools we believe are unique to APT10. HAYMAKER and SNUGRIDE have been used as first stage backdoors, while BUGJUICE and a customized version of the open source QUASARRAT have been used as second stage backdoors. These new pieces of malware show that APT10 is devoting resources to capability development and innovation.\n This recent APT10 activity has included both traditional spear phishing and access to victim\u2019s networks through service providers.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT10 spear phishes have been relatively unsophisticated, leveraging .lnk files within archives, files with double extensions (e.g. \u201c[Redacted]_Group_Meeting_Document_20170222_doc_.exe) and in some cases simply identically named decoy documents and malicious launchers within the same archive.\n ",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to the spear phishes, FireEye ISIGHT Intelligence has observed APT10 accessing victims through global service providers.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Service providers have significant access to customer networks, enabling an attacker who had compromised a service provider to move laterally into the network of the service provider\u2019s customer. In addition, web traffic between a service provider\u2019s customer and a service provider is likely to be viewed as benign by network defenders at the customer, allowing the attacker to exfiltrate data stealthily. A notable instance of this observed by FireEye involved a SOGU backdoor that was set to communicate with its C2 through a server belonging to the victim\u2019s service provider.\n  APT10 actors issued the following commands to a SOGU implant at a victim:\nThese commands included setting persistence on the victim\u2019s system.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The actor then tested connectivity to an IP managed by the victim\u2019s service provider. Once connectivity to the service provider IP was verified, the actor established the service provider IP as a proxy for the victim\u2019s SOGU backdoor. This effectively routes SOGU malware traffic through the victim\u2019s service provider, which likely indicates a foothold on the service provider\u2019s network.",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The tactic also serves to mask malicious C2 and exfiltration traffic and make it appear innocuous.\n",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "APT10 is a threat to organizations worldwide. Their abuse of access to service provider networks demonstrates that peripheral organizations continue to be of interest to a malicious actor \u2013 especially those seeking alternative angles of attack. We believe the pace of APT10 operations may slow following the public disclosure by the PwC/BAE blog; however, we believe they will return to their large-scale operations, potentially employing new tactics, techniques and procedures. \n Get the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "APT10 MenuPass Group _ New Tools & New Global Campaign.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In 2018, the Cybereason Nocturnus team identified an advanced, persistent attack targeting global telecommunications providers carried out by a threat actor using tools and techniques commonly associated with Chinese-affiliated threat actors, such as APT10.   This multi-wave attacks focused on obtaining data of specific, high-value targets and resulted in a complete takeover of the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Earlier this year, Cybereason identified an advanced, persistent attack targeting telecommunications providers that has been underway for years, soon after deploying into the environment.\n Cybereason spotted the attack and later supported the telecommunications provider through four more waves of the advanced persistent attack over the course of 6 months.\n Based on the data available to us, Operation Soft Cell has been active since at least 2012, though some evidence suggests even earlier activity by the threat actor against telecommunications providers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor was attempting to steal all data stored in the active directory, compromising every single username and password in the organization, along with other personally identifiable information, billing data, call detail records, credentials, email servers, geo-location of users, and more.\n The tools and TTPs used are commonly associated with Chinese threat actors\nDuring the persistent attack, the attackers worked in waves- abandoning one thread of attack when it was detected and stopped, only to return months later with new tools and techniques.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Add an additional security layer for web servers. For example, use WAF (Web Application FW) to prevent trivial attacks on Internet-facing web servers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Make sure that all web servers and web services that are exposed are patched.\n Use an EDR tool to give visibility and immediate response capabilities when high severity incidents are detected.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Proactively hunt in your environment for sensitive assets periodically.\n INITIAL COMPROMISE: THE MODIFIED CHINA CHOPPER WEB SHELL\nMAINTAINING A LONG-TERM FOOTHOLD AND STEALING DATA\nWatch our CEO Lior Div's keynote on the operation.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In 2018, 30% of the telecommunications providers reported sensitive customer information was stolen due to an attack. These telecommunications providers have been expanding in size, to the point where In the past thirteen years, mobile cellular phone subscribers have quadrupled in size and sit at 8 billion subscribers today. Due to their wide availability and the fundamental service they bring, telecommunications providers have become critical infrastructure for the majority of world powers.\n Watch the On-Demand Version of Our Operation Soft Cell Webinar\nMuch like telecommunication providers, many other critical infrastructure organizations provide a valuable targets for nation state threat actors, due to their high impact.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In studies, nearly a quarter of critical infrastructure organizations reported they had been hit by nation state attacks and 60% said disruptive cyber attacks are among the threats they are most worried about.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Threat actors, especially those at the level of nation state, are seeking opportunities to attack these organizations, conducting elaborate, advanced operations to gain leverage, seize strategic assets, and collect information.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Last year, we identified a threat actor that has been operating in telecommunications provider environments for at least two years.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We performed a post-incident review of the attacks and were able to identify changes in the attack patterns along with new activity every quarter.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor mainly sought to obtain CDR data (call logs, cell tower locations, etc.)",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This type of targeted cyber espionage is usually the work of nation state threat actors.\n We\u2019ve concluded with a high level of certainty that the threat actor is affiliated with China and is likely state sponsored. The tools and techniques used throughout these attacks are consistent with several Chinese threat actors, such as APT10, a threat actor believed to operate on behalf of the Chinese Ministry of State Security (MSS).\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attack began with a web shell running on a vulnerable, publicly-facing server, from which the attackers gathered information about the network and propagated across the network. The threat actor attempted to compromise critical assets, such as database servers, billing servers, and the active directory.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The second wave of the attack hit several months later with similar infiltration attempts, along with a modified version of the web shell and reconnaissance activities. A game of cat and mouse between the threat actor and the defenders began, as they ceased and resumed their attack 2 more times in the span of a 4 month period.\n The initial indicator of the attack was a malicious web shell that was detected on an IIS server, coming out of the w3wp.exe process. An investigation of the web shell, later classified as a modified version of the China Chopper web shell, uncovered several attack phases and TTPs. The threat actor was able to leverage the web shell to run reconnaissance commands, steal credentials, and deploy other tools.\n Malicious web shell activity as observed in the Cybereason solution. Commands executed via a modified version of the China Chopper web shell.\n China Chopper is a web shell first discovered in 2012 that is commonly used by malicious Chinese actors. It is used to remotely control web servers, and has been used in many attacks against Australian web hosting providers.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The web shell parameters in this attack match to the China Chopper parameters, as described in FireEye\u2019s analysis of China Chopper.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This tool has been used by several Chinese-affiliated threat actors, such as APT 27 and APT 40.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is important to note that this tool is widely available and can be used by other threat actors.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor launched a series of reconnaissance commands to try to obtain and enumerate information about the compromised machine, network architecture, users, and active directory enumeration.\n One of the reconnaissance commands was to run a modified nbtscan tool (\"NetBIOS nameserver scanner\") to identify available NetBIOS name servers locally or over the network. Nbtscan has been used by APT10 in Operation Cloud Hopper to search for services of interest across the IT estate and footprint endpoints of interest.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "NetBIOS Scanner execution as seen in the Cybereason solution.\n NetBIOS scanner is set to scan an internal IP range.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Following the reconnaissance phase, the threat actor attempted to dump credentials stored on the compromised machines. The most common credential stealing tool used by the threat actor was a modified mimikatz that dumps NTLM hashes. This version of mimikatz did not require any command line arguments, most likely in an attempt to avoid detection based on command-line auditing. The dumped hashes were used to authenticate to other machines via pass the hash.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In order to obtain credentials, the threat actor used another technique that can be seen in the below screenshots.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "They dumped specific hives from the Windows Registry, such as the SAM hive, which contains password hashes.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the threat actor mapped the network and obtained credentials (through net use), they began to move laterally. They were able to compromise critical assets including production servers and database servers, and they even managed to gain full control of the Domain Controller. The threat actor relied on WMI and PsExec to move laterally and install their tools across multiple assets.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following example demonstrates how the threat actor moved laterally from the first machine, compromised by the modified version of the China Chopper web shell, to other machines inside the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\"C:\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\ecp\\auth\\\"&wmic /node:[REDACTED] /user:\"[REDACTED]\" /password:\"[REDACTED]\" process call create a.bat&echo [S]&cd&echo [E]\nWMI command used by the threat actor to move laterally.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor abused the stolen credentials to create rogue, high-privileged domain user accounts which they then used to take malicious action.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By creating these accounts, they ensured they would maintain access between different waves of the attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once the threat actor regains their foothold, they already have access to a high-privileged domain user account.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This significantly reduces the \u201cnoise\u201d of having to use credential dumpers repeatedly, which helped them evade detection.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A second method the threat actor used to maintain access across the compromised assets was through the deployment of the PoisonIvy RAT (PIVY). This infamous RAT has been associated with many different Chinese threat actors, including APT10, APT1, and DragonOK. It is a powerful, multi-featured RAT that lets a threat actor take total control over a machine.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Among its most notable features are:\nFile Manager with Upload and Download Support\nKeylogging and Various other Surveillance Features\nThe control panel for PoisonIvy. Courtesy of Sam Bowne - samsclass.info\nWe assume the threat actor used PoisonIvy for keylogging and other surveillance features, as they had that functionality available to them as shown in the screenshot above. \n The strain of PIVY in this attack used a DLL side-loading technique to stealthily load itself into memory.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The PIVY payload was dropped along with the trusted and signed Samsung tool (RunHelp.exe) in the following manner:\nPost-persistence execution of PIVY, side-loaded into a legitimate Samsung application.\n PIVY\u2019s use of DLL side-loading to abuse Samsung tools is not new, and has been reported previously by Palo Alto. In 2016 it was used to attack pro-democratic activists in Hong Kong, most probably by Chinese threat actors.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u26a0\ufe0f Note: Our team has reached out to and advised the targeted organizations on active containment actions.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In later stages of the attack, the threat actor deployed two other custom-built web shells.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "From these web shells, they launched reconnaissance commands, stole data, and dropped additional tools including portqry.exe, renamed cmd.exe, winrar, and the notorious hTran.\n Reconnaissance and lateral movement commands launched from the secondary web shell.\n The threat actor exfiltrated stolen data using multiple different channels including web shells and hTran.\n In an attempt to hide the contents of the stolen data, the threat actor used winrar to compress and password-protect it.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The winrar binaries and compressed data were found mostly in the Recycle Bin folder, a TTP that was previously observed in APT10-related attacks, as well as others.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This threat actor is known to stage the data in multi-part archives before exfiltration.\n The threat actor used the following commands to compress the data.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The contents of the compressed data was crucial in understanding the threat actor\u2019s motivation for the attack, as well as what type of information they were after.\n In order to exfiltrate data from a network segment not connected to the Internet, the threat actor deployed a modified version of hTran.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This \u2018connection bouncer\u2019 tool lets the threat actor redirect ports and connections between different networks and obfuscate C2 server traffic.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There have been numerous reports of hTran being used by different Chinese threat actors, including: APT3, APT27 and DragonOK.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor made some modifications to the original source code of hTran. Many strings, including the debug messages, were intentionally changed and obfuscated in an attempt to evade detection and thwart efforts to identify the malware by antivirus and researchers.\n Since the original source code for hTran is publicly available, we were able to compare the debug output to the original source code to show that it has indeed been modified.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By looking at the original source code, we were able to identify that this is supposed to be \u201cConnect error\u201d.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When you think of large breaches to big organizations, the first thing that comes to mind is usually payment data. An organization that provides services to a large customer base has a lot of credit card data, bank account information, and more personal data on its systems.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In contrast, when a nation state threat actor is attacking a big organization, the end goal is typically not financial, but rather intellectual property or sensitive information about their clients.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One of the most valuable pieces of data that telecommunications providers hold is Call Detail Records (CDRs). CDRs are a large subset of metadata that contains all details about calls, including:\nFor a nation state threat actor, obtaining access to this data gives them intimate knowledge of any individuals they wish to target on that network. It lets them answer questions like:\nHaving this information becomes particularly valuable when nation-state threat actors are targeting foreign intelligence agents, politicians, opposition candidates in an election, or even law enforcement.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Beyond targeting individual users, this attack is also alarming because of the threat posed by the control of a telecommunications provider. Telecommunications has become critical infrastructure for the majority of world powers.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A threat actor with total access to a telecommunications provider, as is the case here, can attack however they want passively and also actively work to sabotage the network.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This attack has widespread implications, not just for individuals, but also for organizations and countries alike. The use of specific tools and the choice to hide ongoing operations for years points to a nation state threat actor, most likely China.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is another form of cyber warfare being used to establish a foothold and gather information undercover until they are ready to strike.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following sections detail the methodology and work process used to piece together the various stages and components of the attack. This work enabled us to not only reconstruct these attacks, but also to find additional artifacts and information regarding the threat actor and its operations.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The first step in this process was to create a comprehensive list of indicators of compromise (IOCs) observed throughout the different stages of the attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This list included various indicators, such as file hashes, domains, IP addresses, file names, and registry/service names.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In addition to this, our reverse engineers were able to extract further IOCs from the collected samples, which have also been added to the list.\n The list of IOCs was periodically updated and fed back into our threat intel engine as more were discovered.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Equipped with an ever-growing list of known IOCs, our team set out to hunt for \u201clow-hanging fruit\u201d across multiple environments. This step was done by using both internal sources, such as the Cybereason solution, as well as hunting for indicators in the wild.\n The hunt for \u201cknown evil\u201d yielded interesting results that helped uncover additional compromised assets as well as more parts of the attack infrastructure.\n Perhaps one of the most interesting steps involved identifying and analyzing the tools the threat actor used throughout the attack. The combination of the preference of tools, sequence of use, and specifically how they are used during the attack says a lot about a threat actor, especially when it comes to attribution.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "One of the more notable aspects was how the threat actor used mostly known tools that were customized for this specific attack.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Each tool was customized differently, and included re-writing the code, stripping debug symbols, string obfuscation, and embedding the victim\u2019s specific information within the tools\u2019 configuration.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, the threat actor also used tools we were not able to attribute to any known tool. These tools were used in the later stages of the attack, once the operation was already discovered.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor made sure that each payload had a unique hash, and some payloads were packed using different types of packers, both known and custom.\n The main tools these attacks had in common are:\nOne of the key components of threat hunting is to create a TTP-based behavioral profile of the threat actor in question.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Malware payloads and operational infrastructure can be quickly changed or replaced over time, and as such, the task of tracking a threat actor can become quite difficult.\n For that reason, it is crucial to profile the threat actor and study its behavior, the tools it uses, and its techniques. These behavioral-based TTPs are less likely to change drastically, and are\\ key factors of any threat hunt or attribution efforts.\n The Cybereason solution is compatible with the MITRE ATT&CK framework, which made it easy to keep track of the observed TTPs and correlate the data with known threat actors.\n The following chart reflects the behavioral profile of the threat actor based on the most frequently observed techniques used throughout these attacks.\n In order to make sense of all the data, we fed it into multiple threat intelligence sources, including our own and third parties.\n \u26a0\ufe0f Note: Since we cannot share any IOCs, we will refer to file hashes, hostnames, IP addresses and other IOCs as generic placeholders.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Hostname1 is the hostname that was used for the C2 server targeting the telecommunications providers.\n In analyzing the files, it is clear they are all contacting the same host hostname1.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once we determined the hashes in the scope of the attack were only connecting to hostname1, which is a dynamic DNS hostname, we looked to see if we could find more information about the C2 server.\n A simple WHOIS query revealed that the IP address was registered to a colocation hosting company in Asia, though there was no other publicly available information about this IP address.\n By querying all of our threat intel resources about this IP address, we discovered that it was associated with multiple dynamic DNS hostnames.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For the other dynamic DNS hosts, we leveraged various threat intel repositories and crafted queries that searched for executables with these IP addresses and hostnames in their string table. One of the queries returned a few DLLs with identical names to the DLL we had initially investigated.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After obtaining the found DLLs, we patched them back into the NSIS installer and detonated the samples in our testing environment. Dynamic analysis of the newly obtained DLLs revealed a new set of domains and IP addresses that were completely different. These domains were actually related to different telecommunications providers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "\u26a0\ufe0f Note: Cybereason immediately reached out to those telecommunications providers and provided them all of the necessary information to handle the incident internally.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We can see many details about the attack including domains and C2 server IP addresses.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The redacted segments contain the name of the customer, C2 IP addresses, and domains.\n The threat actor had a specific pattern of behavior that allowed us to understand their modus operandi: they used one server with the same IP address for multiple operations.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor separated operations by using different hostnames per operation, though they are hosted on the same server and IP address. The domains and server registration information pointed to three main countries: China, Hong Kong, and Taiwan.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is cheap and efficient for the threat actor, but is almost transparent for a seasoned researcher with access to the right threat intelligence tools. There are previous reports of threat actors including APT10 and APT1 using dynamic DNS.\n Monitoring this infrastructure gave us information about if and when the threat actor was starting new waves of the attack or additional attacks on other providers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When researching C2 servers, it is important to watch for:\nAssociation with domains, especially if they are dynamic DNS domains.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "File hashes that are associated with the IP address or the domain of the C2 server.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Static information and metadata from associated samples that could be used to broaden the search after additional information is gathered.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This demonstrates the importance of proper operational security and a separation between tools and operations for threat actors.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In most cases, it is very difficult to achieve 100% certainty when attributing an attack to a specific threat actor.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It can be tempting to attribute an attack to a certain threat actor whenever certain tools-of-the-trade, IP addresses, strings, or \u201cindicative\u201d techniques are observed.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, it is important to bear in mind that the aforementioned data points are often prone to manipulation and reuse across different threat actors. Further, they are not impervious to psychological warfare, as in, trying to \u201cpin\u201d an operation on a different threat actor to avoid proper attribution.\n In order to increase the certainty level when attributing to a specific threat actor, we took the following aspects of the attacks into consideration: \nCarefully examining each of the different aspects plays an important role in avoiding misattribution. This model offers a more balanced interpretation of the data that is based on a myriad of components. By performing a contextualized review of the data, you are able to yield a more wholesome result with greater certainty.\n When it comes to attributing Operation Soft Cell, we are unable to achieve 100% certainty with regard to the identity of the threat actor. However, based on our interpretation of the data, we conclude with a high level of certainty that:\nThe threat actor behind Operation Soft Cell is likely state-sponsored.\n The threat actor is affiliated with China.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "After following the above attribution model and carefully reviewing the data, we are able to narrow down the suspect list to three known APT groups, all of which are known to be linked to China- APT10, APT27, and DragonOK.\n Having found multiple similarities to previous attacks, it is our estimation that the threat actor behind these attacks is likely linked to APT10, or at the very least, to a threat actor that shares tools, techniques, motive and infrastructural preferences with those of APT10.\n While we cannot completely rule out a \u201ccopy-cat\u201d scenario, where another threat actor might masquerade as APT10 to thwart attribution efforts, we find this option to be less likely in light of our analysis of the data.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this blog, we have described an ongoing global attack against telecommunications providers that has been active since at least 2017.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The threat actor managed to infiltrate into the deepest segments of the providers\u2019 network, including some isolated from the internet, as well as compromise critical assets.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our investigation showed that these attacks were targeted, and that the threat actor sought to steal communications data of specific individuals in various countries.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Throughout this investigation, we have uncovered the infrastructure that facilitated the malicious operations taken by this threat actor.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The data exfiltrated by this threat actor, in conjunction with the TTPs and tools used, allowed us to determine with a very high probability that the threat actor behind these malicious operations is backed by a nation state, and is affiliated with China.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our contextualized interpretation of the data suggests that the threat actor is likely APT10, or at the very least, a threat actor that shares, or wishes to emulate its methods by using the same tools, techniques, and motives.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It\u2019s important to keep in mind that even though the attacks targeted specific individuals, any entity that possesses the power to take over the networks of telecommunications providers can potentially leverage its unlawful access and control of the network to shut down or disrupt an entire cellular network as part of a larger cyber warfare operation.\n ",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Due to multiple and various limitations, we cannot disclose all the information we have gathered on the attack in this report.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Our team will continue to monitor and track the threat actor\u2019s activity in order to identify more tools and compromised organizations.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Closing Notes: This research, which is still ongoing, has been a huge effort for the entire Cybereason Nocturnus team. Special thanks goes to Niv Yona, Noa Pinkas, Josh Trombley, Jakes Jansen, and every single member of the Nocturnus team for the countless hours and effort that were put into this research.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We will continue to monitor and update our blog with more information once available and as our investigation progresses.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Cybereason Nocturnus Team has brought the world\u2019s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n Cybereason GSOC observed distribution of the Bumblebee Loader and post-exploitation activities including privilege escalation, reconnaissance and credential theft. Bumblebee operators use the Cobalt Strike framework throughout the attack and abuse credentials for privilege escalation to access Active Directory, as well as abusing a domain administrator account to move laterally, create local user accounts and exfiltrate data...\n Recently, IcedID, also known as BokBot, has been used more as a dropper for other malware families and as a tool for initial access brokers.\n",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By clicking \u201cAccept All Cookies\u201d, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts.",
        "source": "Operation Soft Cell_ A Worldwide Campaign Against Telecommunications Providers.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this blog post, we analyze ChessMaster's current status, including the updated tools in its arsenal \u2014 with a particular focus on the evolution of ANEL and how it is used in the campaign.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By: Tamada Kiyotaka, MingYen Hsieh\nMarch 29, 2018\nRead time: 7 min (1963 words)\nTrend Micro discovered the ChessMaster campaign back in July 2017 as part of our monitoring efforts to protect our customers.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At the time, we found ChessMaster targeting different sectors from the academe to media and government agencies in Japan. The threat group used a variety of attack tools and techniques to spy on their target organizations.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Back then, we noted that ChessMaster's sophisticated nature implied that the campaign could evolve, before finding changes in the tools and tactics used in the campaign a few months later.   While the original campaign was comprehensive and used remote access Trojans (RATs) such as ChChes and RedLeaves, this new campaign used a new backdoor (Detected by Trend Micro as BKDR_ANEL.ZKEI) that leverages the CVE-2017-8759 vulnerability for its cyberespionage activities.\n In this blog post, we analyze ChessMaster's current status, including the updated tools in its arsenal \u2014 with a particular focus on the evolution of ANEL and how it is used in the campaign.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Infection Chain for the current ChessMaster campaign\nChessMaster\u2019s current iteration starts off with the familiar phishing attacks seen in the earlier campaigns that involved the use of an email with an attached malicious document using the doc, docx, rtf, csv and msg formats. The email title and attached file name were written in Japanese and contain general business, political, and economy-themed phrases such as\nHowever, there is a change in the exploit document.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When we tracked ChessMaster back in November, we noted that it exploited the SOAP WSDL parser vulnerability CVE-2017-8759 (patched in September 2017) within the Microsoft .NET framework to download additional malware. While ChessMaster still uses the previous exploit, it also added more methods to its arsenal: one exploits another vulnerability, CVE-2017-11882 (patched in November 2017), which was also exploited to deliver illegal versions of the Loki infostealer.\n It also abuses three legitimate MS Office functions:\nFigure 4.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Exploitation of Link Auto Update\nChessMaster can utilize any of these methods to download the next malware in the chain, the open source post-exploitation tool known as \u201cKoadic,\u201d which the previous campaign also used. This tool is responsible for stealing information \u2014 specifically the environment information \u2014 within the target system. Koadic executes the following command:\nThe commands and output of Koadic will change according to the ANEL version used in the attack. The table below lists examples of the commands and outputs for ANEL versions 5.1.1 rc and 5.1.2 rc1.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Note that if ANEL 5.1.2 rc1 was downloaded, the attacker would use HTTPS to avoid the downloaded data being captured as clear text.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 6. Koadic commands and output when ANEL 5.1.1 rc is used\nFigure 7. Koadic commands and output when ANEL 5.1.2 rc1 is used\nThe table below lists all of Koadic's functions:\nFigure 8. Command added when the Koadic RAT is downloaded (use of {Variable}.shell.exec command)\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If Koadic finds that the system is conducive to the attacker\u2019s interests, it downloads a base64-encrypted version of the ANEL malware from the Command-and-Control (C&C) server and executes it.  ",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Encrypted ANEL is decrypted using the \u201ccertutil -docode\u201d command. When ANEL executes, a decrypted DLL file with the filename \u201clena_http_dll.dll\u201d is expanded in memory.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Base64 encoded ANEL downloaded by Koadic\nANEL will send the infected environment\u2019s information to the C&C server.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When sending the information, ANEL encrypts the data using blowfish, XOR, and Base64-based encryption methods.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The format ANEL uses to send data is similar to ChChes, but ANEL's encryption method is easier to use.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We initially discovered the malware known as ANEL back in September 2017. At that time, ChessMaster was using ANEL as a backdoor into the target system then injects code into svchost.exe, which then decrypts and activates the embedded backdoor. This initial version of ANEL had a hardcoded version labeled \u201c5.0.0 beta1\u201d that contained incomplete code.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The figure below shows a summary of the changes between each version:\nFigure 11. Summary of the changes between each version of ANEL\nDifferences with regards to Backdoor commands:\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "For example, the initial ANEL version, \u201c5.0.0 beta1,\u201d uses a different C&C server compared to the other versions. Once ANEL evolved to \u201c5.1.1 rc,\u201d it changed its file type to an executable, while also changing the C&C server. The third version we found (5.1.2 rc1) reverts to a DLL file type but retains the C&C server. The fourth version of ANEL (5.2.0 rev1) changes both the export function in the expanded main ANEL DLL and uses a different C&C server.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Overall, we can see subtle changes, which indicate that the threat actors behind ANEL are making incremental improvements to the malware to refine it.\nFigure 12.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Backdoor function differences between ANEL 5.0.0 beta1/5.1.1 rc/5.1.2 rc1 (left) and ANEL 5.2.0 rev1 (right)\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Once ANEL enters the user\u2019s system, it will download various tools that could be used for malicious purposes, including password retrieval tools as well as malicious mail services and accessibility tools that will allow it to gather information about the system.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It also downloads the following:\nThese three files work together using a common technique call DLL Side-Loading or DLL Hijacking.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this scenario, accevent.exe is the primary executable, which is usually legitimate.\n After the execution of accevent.exe, it loads event.dll, which will be placed in the same folder (so it takes loading priority), after which event.dll decrypts and loads the encrypted backdoor ssssss.ddd, which is BKDR_ANEL.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When the user opens the document DDEAUTO or Link Auto Update, Office will display a message.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 13: Popup message when users open the document that abuses DDEAUTO\nFigure 14. Popup message when the user opens the document that abuses Link Auto Update\nKoadic sends its own JavaScript code as plain text. The suspect communication allows us to detect the traffic.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "At first glance, it seems ChessMaster\u2019s evolution over the past few months involves subtle changes.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, the constant addition and changing of features and attack vectors indicate that the attackers behind the campaign are unlikely to stop and are constantly looking to evolve their tools and tactics.\n Organizations can implement various techniques and best practices to defend against targeted attacks, such as regular patching to prevent vulnerability exploitation and using tools that provide protection across different network levels.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Solutions that feature behavior monitoring, application control, email gateway monitoring, and intrusion/detection systems can help with this.\n Given how cybercriminal tools, tactics and procedures are evolving, organizations will have to go beyond their typical day-to-day security requirements and find a way to preempt attacks. Thus, there is a pressing need to detect and address threats via a proactive incident response strategy. Essentially, this involves creating a remediation plan for effectively combating the threat and using round-the-clock intrusion detection and threat analysis to prevent attacks from entering the system.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A proactive strategy can be much more effective for targeted attacks, as these kinds of attacks are often designed to be elusive and difficult to detect, thus the need to scope them out. A comprehensive security strategy that involves proactive incident response will need the input of both decision makers and tech-savvy personnel, as they will need to be on the same page for it to be effective.\n In addition to implementing both mitigation techniques and proactive strategies, organizations can also strengthen their security by employing solutions such Trend Micro\u2122 Deep Security\u2122 and TippingPoint, which protects endpoints from threats that abuse vulnerabilities.\n In addition, comprehensive security solutions can be used to protect organizations from attacks.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These include Trend Micro endpoint solutions such as Trend Micro\u2122 Smart Protection Suites and Worry-Free\u2122 Business Security, which can protect users and businesses from these threats by detecting malicious files, well as blocking all related malicious URLs. Trend Micro Deep Discovery\u2122 can protect enterprises by detecting malicious attachment and URLs.\n Trend Micro OfficeScan\u2122 with XGen\u2122 endpoint security infuses high-fidelity machine learning with other detection technologies and global threat intelligence for comprehensive protection against all kinds of threats. A more detailed analysis of the Command-and-Control communication flow of ANEL can be found in this technical brief.\n",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Hash Downloader used in the campaign:\nHashes detected as part of the BKDR_ANEL Family: 5.0.0 beta1\nURLs and IP Addresses related to the campaign:\nTry our services free for 30 days\nPrivacy | Legal | Accessibility | Site map\nCopyright \u00a92023 Trend Micro Incorporated.",
        "source": "ChessMaster Adds Updated Tools to Its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "mandiant.com uses cookies to deliver and enhance the quality of its services and to analyze traffic. If you agree, cookies are also used to serve advertising and to personalize the content and advertisements that you see.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In July 2018, FireEye devices detected and blocked what appears to be APT10 (Menupass) activity targeting the Japanese media sector. APT10 is a Chinese cyber espionage group that FireEye has tracked since 2009, and they have a history of targeting Japanese entities.\n In this campaign, the group sent spear phishing emails containing malicious documents that led to the installation of the UPPERCUT backdoor.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This backdoor is well-known in the security community as ANEL, and it used to come in beta or RC (release candidate) until recently.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Part of this blog post will discuss the updates and differences we have observed across multiple versions of this backdoor.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attack starts with Microsoft Word documents containing a malicious VBA macro being attached to spear phishing emails.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Although the contents of the malicious documents are unreadable (see Figure 3), the Japanese titles are related to maritime, diplomatic, and North Korean issues.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Government Recommendations from the Liberal Democratic Party\u2019s Comprehensive Strategic Maritime Subcommittee\nInvitation to Lecture by Guatemalan Ambassador\nNorth Korean interior swayed by the approach of the United States\nFor the North Korean lure, a news article with an identical title was readily available online. It\u2019s also worth noting that in the Guatemalan lure, the attacker used an unusual spelling of Guatemala in Japanese. The top result of a Google search using the same spelling led us to the event website for the lecture of the Guatemalan Ambassador, held in August 2018. Figure 1 shows the screenshot of the event page.\n Figure 2 shows the macro function that displays the lure document. At the bottom of this function, we can see the readable text that matches the contact information found in Figure 1. Thus, people who would have an interest in Latin American issues may have been the targets of this campaign.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The initial Word documents were password protected, likely in an effort to bypass detection. Once the password (delivered in the body of the email) is entered, the users are presented with a document that will request users to enable the malicious macro, as shown in Figure 3.\nFigure 4 shows what happens when the malicious macro is executed.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The macro drops three PEM files, padre1.txt, padre2.txt, and padre3.txt, to the victim\u2019s %TEMP% folder and then copies them from %TEMP% to the %AllUserProfile% folder.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The macro decodes the dropped files using Windows certutil.exe with the following commands (certutil.exe is a legitimate built-in command-line program to manage certificates in Windows):\nC:\\Windows\\System32\\cmd.exe\" /c",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "certutil -decode C:\\ProgramData\\padre1.txt C:\\ProgramData\\\\GUP.txt\nC:\\Windows\\System32\\cmd.exe\" /c certutil -decode C:\\ProgramData\\padre2.txt C:\\ProgramData\\\\libcurl.txt\nC:\\Windows\\System32\\cmd.exe\" /c certutil -decode C:\\ProgramData\\padre3.txt C:\\ProgramData\\\\3F2E3AB9\n3.     ",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The macro creates a copy of the files with their proper extensions using Extensible Storage Engine Utilities (esentutil.exe) with the following commands (esentutil.exe is also a legitimate program that is pre-installed in Windows):\nC:\\Windows\\System32\\esentutl.exe\" /y",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The macro deletes the initially dropped .txt files using Windows esentutl.exe and changes the document text to an embedded message.\n The complete attack overview is shown in Figure 7.\n Several threat actors leverage the technique of using Windows certutil.exe for payload decoding, and APT10 continues to employ this technique.\n Figure 8 shows the timeline of updates for UPPERCUT. The PE compile time of loaders and the create time of droppers (Word documents) are plotted in the graph. The compile time of loaders in the newer version(s) are not shown here since the timestamps are overwritten and filled with zeroes.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We don\u2019t have visibility into UPPERCUT 5.2.x series, but it\u2019s possible that minor revisions were released every few months between December 2017 and May 2018.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Unlike previous versions, the exported function names are randomized in the latest version (Table 2).\n Table 2: Static characteristics of UPPERCUT\nAnother new feature in the latest UPPERCUT sample is that the malware sends an error code in the Cookie header if it fails to receive the HTTP response from the command and control (C2) server. The error code is the value returned by the GetLastError function and sent in the next beacon.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This was likely included to help the attackers understand the problem if the backdoor is unable to receive a response (Figure 9).",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This Cookie header is a unique indicator that can be used for network-based detection.\n Earlier versions of UPPERCUT used the hard-coded string \u201cthis is the encrypt key\u201d for Blowfish encryption when communicating with a C2. However, in the latest version, the keys are hard-coded uniquely for each C2 address and use the C2\u2019s calculated MD5 hash to determine which key to use, as shown in Figure 10.\n For instance, Table 3 lists the hard-coded C2 addresses, their MD5 hash, and the corresponding Blowfish key in the decoded payload of 126067d634d94c45084cbe1d9873d895.\nTable 3: Example of Blowfish keys\nIn this example, the MD5 hash of hxxp[:]//151.106.53[.]147/VxQG will be f613846eb5bed227ec1a5f8df7e678d0.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When the malware interacts with this URL, bdc4b9f5af9868e028dd0adc10099a4e6656e9f0ad12b2e75a30f5ca0e34489d will be selected as a Blowfish key. If the MD5 hash of the URL does not match any of the listed hashes, then the default key f12df6984bb65d18e2561bd017df29ee1cf946efa5e510802005aeee9035dd53 will be used.\n Another difference in the network traffic generated from the malware is that the encoded proxy information has been added in the URL query values during the C2 communication. Table 4 shows the parameters sent to C2 server from the backdoor in the newer versions.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Two more commands, 0xD290626C85FB1CE3 and 0x409C7A89CFF0A727, are supported in the newer versions (Table 5).\n Download and validate file (XXHash comparison) from C2 server\nDownload, validate (XXHash comparison), execute file, and send output to C2 server\nCapture the desktop screenshot in PNG format and send it to C2\nThe received buffer is executed via cmd.exe and the output is then sent to the C2 server\nWhile APT10 consistently targets the same geolocation and industry, the malware they use is actively evolving. In the newer versions of UPPERCUT, there is a significant change in the way backdoor initializes the Blowfish encryption key, which makes it harder for analysts to detect and decrypt the backdoor\u2019s network communications.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "To mitigate the threat, users are advised to disable Office macros in their settings and not to open documents from unknown sources.",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "FireEye Multi-Vector Execution (MVX) engine is able to recognize and block this threat with the following detection names:\nGet the Google Cloud Cybersecurity Forecast 2024 report to explore the latest trends on the horizon.\n",
        "source": "APT10 Targets Japanese Corporations _ UPPERCUT backdoor.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In previous posts, Intrusion Truth showed that the Cloud Hopper / APT10 hackers that attacked thousands of global clients of Managed Service Providers (MSPs) in 2016 were based in Tianjin, China.\n We identified Zheng Yanbin, Gao Qiang and Zhang Shilong as three actors responsible. We associated them with the Huaying Haitai Science and Technology Development Co Ltd (\u5929\u6d25\u534e\u76c8\u6d77\u6cf0\u79d1\u6280\u53d1\u5c55\u6709\u9650\u516c\u53f8) and Laoying Baichen Instruments Equipment Co Ltd in Tianjin China.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the course of our investigation over the last year, we engaged with several Cyber Threat Intelligence analysts who provided both raw data and analysis to our team. Amongst the data provided to us recently was evidence that Gao Qiang has been working with the Chinese state.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This image, which was provided by an analyst who prefers not to be named publicly (but whose identity we have independently verified), shows an Uber receipt addressed to a user called \u2018Qiang\u2019 (\u5f3a) and bears the e-mail address 420192[at]qq.com, an account that we believe to be used by APT10 actor Gao Qiang.\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The receipt shows travel at the end of the working day between 384 Jiefang South Road (\u89e3\u653e\u5357\u8def) \u2013 immediately outside the Fuyu Mansion address of Huaying Haitai \u2013 and a destination in what appears to be a residential area of the Xiqing District of Tianjin just south of the Waihuan River.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have blacked out the exact street number in the image.   This map shows the location of the start of the journey, outside the Fuyu Mansion buildings.\n This second Uber receipt, provided by the same analyst, shows further travel by the same user, though here he uses the name \u2018Pig\u2019 (\u732a). This could be some attempt to disguise the nature of the journey, though readers will note the same QQ e-mail address is used.\n In this case the journey is between the same residential area in the Xiqing District and a large complex at 85 Zhujiang Road (\u73e0\u6c5f\u9053), Tianjin.\n According to the rest of the data revised by analysts working for this blog, this was one of a number of journeys made by the user to/from the same complex on Zhujiang Road.\n 85 Zhujiang Road is an important address in Tianjin \u2013 it is the headquarters of the Tianjin State Security Bureau (\u5929\u6d25\u5e02\u56fd\u5bb6\u5b89\u5168\u5c40), a regional arm of the Ministry of State Security (MSS). MSS is the same Chinese Intelligence Service that was tasking APT3 via a cover company managed by its office in Guangdong.\n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This looks like what it is \u2013 an exact copy of the APT3 model. This was a large scale infiltration of western infrastructure conducted by a team of Chinese citizens working for a small company with links to the Chinese Intelligence Service, MSS.",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is the second time that this blog has proven a link between a damaging APT group and the Chinese state (and it certainly won\u2019t be the last).\n someone with the same name as an apparent APT10 hacker,\ntravelled from the same building as an APT10 associated company, and\nmet frequently with the Ministry of State Security in Tianjin.\n APT10 was the work of the Chinese Ministry of State Security. \n",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Who is Mr Gao?\nAugust 2, 2018\n In \"APT10\"\nWho is Mr Zhang?\nAugust 6, 2018\n In \"APT10\"\nMore on Huaying Haitai and Laoying Baichaun, the companies associated with APT10. Is there a state connection?\nAugust 9, 2018\nIn \"APT10\"",
        "source": "APT10 was managed by the Tianjin bureau of the Chinese Ministry of State Security \u2013 Intrusion Truth.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In this article, I\u2019d like to share some of our findings about ChChes (which we introduced in a previous article) that it leverages PowerSploit",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The samples that JPCERT/CC confirmed this time infect machines by leveraging shortcut files. The flow of events from a victim opening the shortcut file until a machine is infected is illustrated in Figure 1.\n When the shortcut file is opened, a file containing PowerShell script is downloaded from an external server and then executed. Next, ChChes code (version 1.6.4) contained in the PowerShell script is injected into powershell.exe and executed.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The detailed behaviour in each phase is described below.\n When the shortcut file is opened, the following PowerShell script contained in the file is executed.\n The PowerShell script after \u201c-enc\u201d is encoded. Below is the decoded script:\nBy executing the above PowerShell script, a file containing PowerShell script is downloaded from a specified URL.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The downloaded script is loaded in 32-bit powershell.exe (syswow64\\WindowsPowerShell\\v1.0\\powershell) and executed. The reason why it is executed in 32-bit is considered to be that ChChes\u2019s assembly code contained in the PowerShell script is not compatible with 64-bit environment.\n Details of the Downloaded PowerShell Script\nThe downloaded PowerShell script is partially copied from PowerSploit (Invoke-Shellcode.ps1).",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "PowerSploit is a tool to execute files and commands on a remote host and is used for penetration tests.\n When the downloaded PowerShell script is executed, it creates document files based on data contained in the script, store the files in the %TEMP% folder and displays them.   We\u2019ve seen different types of documents shown, including Excel and World documents.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Next, ChChes code contained in the PowerShell is injected into powershell.exe. The injected ChChes receives commands and modules from C2 servers as explained in the previous blog post. The PowerShell script and the injected ChChes are not saved as files in the infected machines, and ChChes itself only exists in the memory.\n Figure 2 is a part of the PowerShell script.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In environments where PowerShell v5.0 is installed (including Windows 10), the PowerShell script downloaded from remote servers are recorded in the event logs under the default settings (as Figure 3).",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Such logs can also be obtained in PowerShell v4.0 (Default version of Windows 8.1) by enabling the following Group Policy.\n",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is now quite common that PowerShell script is leveraged for attacks. If your event log configuration is not set to record PowerShell execution, it is recommended that you revise the settings in preparation for such attacks. Also, if you are not using PowerShell, it is suggested to restrict the execution by using AppLocker, etc.\n Since December 2012, he has been engaged in malware analysis and forensics investigation, and is especially involved in analyzing incidents of targeted attacks. Prior to joining JPCERT/CC, he was engaged in security monitoring and analysis operations at a foreign-affiliated IT vendor.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n This form is for comments and inquiries.",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "MalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nYAMA-Yet Another Memory Analyzer for malware detection\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\nGobRAT malware written in Go language targeting Linux routers\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nHow to Use Volatility 3 Offline",
        "source": "Malware Leveraging PowerSploit - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A large-scale attack campaign is targeting multiple Japanese companies, including subsidiaries located in as many as 17 regions around the globe in a likely intelligence-gathering operation.\n Companies in multiple sectors are targeted in this campaign, including those operating in the automotive, pharmaceutical, and engineering sector, as well as managed service providers (MSPs).\n The scale and sophistication of this attack campaign indicates that it is the work of a large and well-resourced group, with Symantec, a division of Broadcom (NASDAQ: AVGO), discovering enough evidence to attribute it to Cicada (aka APT10, Stone Panda, Cloud Hopper). Cicada has been involved in espionage-type operations since 2009, and U.S. government officials have linked the activities of APT10, which we track as Cicada, to the Chinese government.\n Cicada has historically been known to target Japan-linked organizations, and has also targeted MSPs in the past.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group is using living-off-the-land tools as well as custom malware in this attack campaign, including a custom malware - Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Among the machines compromised during this attack campaign were domain controllers and file servers, and there was evidence of files being exfiltrated from some of the compromised machines.\n The attackers extensively use DLL side-loading in this campaign, and were also seen leveraging the ZeroLogon vulnerability that was patched in August 2020.\n This campaign was first discovered by Symantec when suspicious DLL side-loading activity on one of our customer\u2019s networks triggered an alert in our Cloud Analytics technology, which is available in Symantec Endpoint Security Complete (SESC). This activity was then reviewed by our Threat Hunter analysts before being passed on to our investigations team for further analysis.\n Cloud Analytics leverages artificial intelligence in order to comb through Symantec\u2019s vast data and spot patterns associated with targeted attacks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is capable of automatically flagging incidents that would otherwise have taken thousands of hours of analyst time to identify.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The initial Cloud Analytics alert allowed our threat hunting team to identify further victims of this activity, build a more complete picture of this campaign, and attribute this activity to Cicada. It also allowed us to update and create new protections to ensure our customers are protected from this activity.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This campaign has been ongoing since at least mid-October 2019, right up to the beginning of October 2020, with the attack group active on the networks of some of its victims for close to a year. The campaign is very wide-ranging, with victims in a large number of regions worldwide.\n The companies hit are, in the main, large, well-known organizations, many of which have links to Japan or Japanese companies, which is one of the main factors tying the victims together.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cicada has been known to have a strong focus on Japanese organizations in previous attack campaigns.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As is clear from the map in Figure 1, South and East Asia are strong areas of focus for the attackers in this campaign. It is unusual to see a reportedly Chinese-government-linked group attacking companies within China\u2019s borders but, like many of the companies targeted in this campaign, the target in that instance is a subsidiary of a Japanese organization.\n We also saw similar loaders on all the victim networks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These are among the main factors linking these victims together, with all of them coming from a wide variety of sectors, including:\nThe amount of time the attackers spent on the networks of victims varied, with the attackers spending a significant amount of time on the networks of some victims, while spending just days on other victim networks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In some cases, too, the attackers spent some time on a network but then the activity would cease, but start again some months later.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We observed the attackers using a wide variety of living-off-the-land, dual-use, and publicly available tools and techniques in these attacks, including:\nThe threat actors also use a legitimate cloud file-hosting service for exfiltration.\n The attackers also use DLL side-loading at multiple stages during the attack, including using it to load Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "DLL side-loading occurs when attackers are able to replace a legitimate library with a malicious one, allowing them to load malware into legitimate processes. Attackers use DLL side-loading to try and hide their activity by making it look legitimate, and it also helps them avoid detection by security software.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It is a tactic that is commonly used by APT groups and has often been observed being used by nation-state backed actors.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Monitoring networks for unusual activity, as Symantec\u2019s Cloud Analytics technology does, is key for detecting this kind of malicious activity.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attackers were also seen deploying a tool capable of exploiting the ZeroLogon vulnerability (CVE-2020-1472).",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The critical elevation-of-privilege vulnerability was first disclosed and patched on August 11, 2020, and can allow attackers to spoof a domain controller account and then potentially use it to steal domain credentials, take over the domain, and completely compromise all Active Directory identity services.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "It has been exploited by multiple malicious actors since its disclosure, leading both Microsoft and the Department of Homeland Security\u2019s (DHS) Cybersecurity and Infrastructure Security Agency (CISA) to issue warnings to Windows users to patch the issue as quickly as possible.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The scale and sophistication of this attack campaign indicate that it is the work of a large and well-resourced group, such as a nation-state actor, with Symantec discovering enough evidence to attribute it with medium confidence to Cicada.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Symantec analysts have linked this activity to Cicada due to the use of previously seen obfuscation techniques and shellcode on loader DLLs.\n  Activity seen in one of the victim organizations has various trait similarities with previously seen Cicada activity that was described in a blog by Cylance in 2019, including:\nIn another affected organization, the loaders deploying Backdoor.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Hartip overlap in the obfuscation and shellcode used, making us confident it is the same actor in both organizations.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Similarities between activity in both organizations\nThese similarities leave us confident that this is the same group carrying out this activity in both organizations, and that this group is Cicada.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Historically, Cicada has been seen using custom DLL loaders to decrypt and execute its final payload, as is observed in these attacks.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We also saw similar loaders as those used in these two organizations used on other victim networks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The scale of the operations also points to a group of Cicada\u2019s size and capabilities. The targeting of multiple large organizations in different geographies at the same time would require a lot of resources and skills that are generally only seen in nation-state backed groups. The link all the victims have to Japan also points towards Cicada, which has been known to target Japanese organizations in the past.\n The targeting of MSPs is also a hallmark of Cicada\u2019s activity.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Successfully compromising an MSP can give attackers high-level access to multiple companies without them having to compromise the individual companies\u2019 networks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have also seen Cicada utilizing some of the same publicly available tools \u2013 such as WMIExec \u2013 in the past. The attackers also take various steps to reduce the chances of their activity being spotted \u2013 including searching for security software on victim machines using WMIC, and using PowerShell to clear event logs to hide their activity once they are finished on victim machines.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This kind of activity is the hallmark of sophisticated and experienced threat actors.\n All of these facts point to Cicada being the perpetrator of these wide-ranging and sophisticated attacks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Intelligence gathering and stealing information has generally been the motivation behind Cicada\u2019s attacks in the past, and that would appear to be the case in this attack campaign too.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We observed the attackers archiving some folders of interest in these attacks, including in one organization folders relating to human resources (HR), audit and expense data, and meeting memos.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Japan-linked organizations need to be on alert as it is clear they are a key target of this sophisticated and well-resourced group, with the automotive industry seemingly a key target in this attack campaign.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, with the wide range of industries targeted by these attacks, Japanese organizations in all sectors need to be aware that they are at risk of this kind of activity.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Cicada clearly still has access to a lot of resources and skills to allow it to carry out a sophisticated and wide-ranging campaign like this, so the group remains highly dangerous.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Its use of a tool to exploit the recently disclosed ZeroLogon vulnerability and a custom backdoor that has not been observed by Symantec before show that it continues to evolve its tools and tactics to actively target its victims.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The group\u2019s use of techniques such as DLL side-loading and a wide array of living-off-the-land tools underline the need for organizations to have a comprehensive security solution in place to detect this kind of suspicious activity before actors like Cicada have the chance to deploy malware or steal information from their networks.\n ",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This activity was first discovered thanks to an alert triggered by our Cloud Analytics technology, which is available in Symantec Endpoint Security Complete (SESC).\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "8b6ad87e408e38fc1db868da6e643f616dac59fbae08382c4a7dd4ea119ea057\nd5e38ac1187c607e701f506c4015bde94be6c485d566d004d810d7565c188743\n26460aa2df29f766cb5712ebca44cb3365ebfdb5cae0b2ec36ef1e3568911d6a\ncdec58a57381bb8c1e374efb0bf1897d89d1e096d2b704820893859d9f08d086\nea9d994de91389280b334f2af991baa49ca613a6bf898d7bb25f88cc66488f5c\n3f5b623222c755d59052fab9e096c9d2b9a47d06b3a5de62fb9a66750af4efc4\n27873e3d4ec3a0e7d66bee8bda4d65cc8fcefbdca2c8d5c049372a63ff0bc2ed\ncf3ae16b01f7eb129e0e7387ac7feb61ecfce5db0d7494b3962c02c681f504d4\n578ea26729b43fd976365a6700c80950e0b71a39e67bfff715423d60ae6bfab9\n03ab1588acaabdb509e9db7cfe1e60522bc8baa13bbd35160b4bde7d1b6402ef\n4a08eb0eb1f4ebb54bceabbebcb7da48238f0278ae5421326ee65ec7951e4239\n178.73.210.238\n188.119.112.225\n213.252.246.245\n45.14.224.93\n45.67.230.134\n81.7.7.159\n95.179.143.32\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.\n",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We encourage you to share your thoughts on your favorite social platform.\n By clicking accept, you understand that we use cookies to improve your experience on our website.",
        "source": "Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign _ Symantec Enterprise Blogs.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We have seen an increase in attacks that leverage malicious LNK files that use legitimate apps\u2014like PowerShell\u2014to download malware or other malicious files.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "By: Benson Sy\nMay 25, 2017\nRead time: 5 min (1251 words)\nUpdate as of May 30, 2017, 5:00 AM CDT to update the date referencing Trojan downloaders that used .zip",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "PowerShell is a versatile command-line and shell scripting language from Microsoft that can integrate and interact with a wide array of technologies. It runs discreetly in the background, and can be used to obtain system information without an executable file.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There were a few notable instances where cybercriminals abused PowerShell: in March 2016 with the PowerWare ransomware, and in a new Fareit malware variant in April 2016.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Because this seemed to be an upward trend, security administrators became more familiar with how to prevent PowerShell scripts from doing any damage.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, cybercriminals are staying ahead of the curve by using alternative means of executing PowerShell script\u2014Windows LNK (LNK) extensions. LNK files are usually seen by users as shortcuts, and used in places like the Desktop and Start Menu.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "And in early 2017, we noted how Trojan downloaders used a .zip within a .zip to disguise a LNK file attachment that led to the Locky ransomware.\n Now, we\u2019re seeing an increase in attacks that leverage malicious LNK files that use legitimate apps\u2014like PowerShell\u2014to download malware or other malicious files. To illustrate how the trend of using LNK files is rising, note how one single LNK malware (identified by Trend Micro as LNK_DLOADR.*) has had a significant jump in detections since January 2017.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Detected LNK_DLOADR over a 4 month period\nIn October 2016 we saw attackers using the combination of LNK, PowerShell, and the BKDR_ChChes malware in targeted attacks against Japanese government agencies and academics.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The attack used a fake .jpg extension to camouflage the malicious PowerShell file.\nFigure 2.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In January 2017 we spotted the group APT10 (also called MenuPass, POTASSIUM, Stone Panda, Red Apollo, and CVNX) using a similar attack for a wide-spread spear phishing campaign. In this version, the LNK file executes CMD.exe, which in turn downloads a fake .jpg file hiding the malicious PowerShell script.\n The group has continued to evolve their cyberespionage activities, and in April 2017 they used a similar strategy to also download BKDR_ChChes, which is a popular malware used in targeted attacks.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We identified one campaign, likely still ongoing, that has a new and complicated LNK strategy.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "These attackers seem to be using several layers of command line, built-in, Windows tools. They send a phishing email with lures that push the victim to \u201cdouble click for content\u201d, typically a DOCX or RTF file embedded with a malicious LNK. Instead of directly executing PowerShell, the LNK file will execute MSHTA.exe (a file used for opening HTML applications), which executes a Javascript or VBScript code that in turn downloads and executes the PowerShell script. The PowerShell then executes a reverse shell (like Metasploit or Cobalt Strike) to complete the compromise.\nFigure 3. Complex LNK attack leveraging MSHTA.exe files\nLast month we identified another spear phishing campaign also using a combination of LNK and PowerShell.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Unfortunately, the Command and Control (C&C) server where the main payload was stored is no longer accessible.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Their strategy seems to have fewer layers: the LNK file is embedded in a document file and if a user double clicks to open the message, it executes a PowerShell file (or a similar Windows command line tool) to download another script.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A less complicated LNK-PowerShell attack\nWe believe this specific attack may be politically motivated due to the economic and controversial subject of the decoy document.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, a full analysis is tricky because the trail ends when one of the C&C servers dies.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Without the full picture, it is difficult to associate this type of attack to known campaigns.\n In many cases, these malicious LNK files can reveal valuable information about the attacker\u2019s development environment. To help get this information, a quick analysis is possible by viewing the properties of the file.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "However, we are encountering cases where the command line argument is so long that it is no longer fully visible in the Properties > Shortcut window.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "When viewed, only the target application (CMD.exe, MSHTA.exe, and other non-malicious command line applications) is seen.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Only the target application is visible\nOur tests revealed that the maximum length for Shortcut > Properties > Target is only 260 characters.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Using a parser tool reveals that it is much longer (figure 6), though it still works normally:\nFigure 6.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Padded file hiding malicious code\nAttackers take advantage of this to try and disguise or hide the malicious portion of the code.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This padding strategy may prevent a quick analysis of a LNK file, but any LNK parser can still extract the arguments without any problem.\n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Malware developers continue to upgrade their tools and look for different ways to deliver their malicious payloads. Leveraging these LNK files is another strategy, but there are ways to prevent and mitigate these threats:\nTo identify if it is a LNK file or not:\nTrend Micro\u2122 Smart Protection with Maximum XGen\u2122 security infuses high-fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across user activity and any endpoint\u2014the broadest possible protection against advanced attacks.\n Trend Micro\u2122 Deep Discovery\u2122 provides detection, in-depth analysis, and proactive response to today\u2019s stealthy malware and targeted attacks in real-time. It provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, custom sandboxing, and seamless correlation across the entire attack lifecycle, allowing it to detect threats, even without any engine or pattern update.   \n",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Try our services free for 30 days\nPrivacy | Legal | Accessibility | Site map\nCopyright \u00a92023 Trend Micro Incorporated.",
        "source": "How Attackers are Using LNK Files to Download Malware.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "JPCERT/CC has confirmed that a group called APT10 used this tool in some targeted attacks against Japanese organisations.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As Quasar\u2019s source code is publicly available, there are many variants of this RAT seen in the wild (referred to as \u201cQuasar Family\u201d hereafter).",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Some of them have been used in attacks against Japanese organisations, and they are seen as a threat as well as Quasar itself.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Quasar offers many functions which are intended for purposes such as device management, support operation and employee monitoring.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This tool was called \u201cxRAT\u201d at the time of its initial release, however, it was renamed as \u201cQuasar\u201d in August 2015. The latest version is v1.4, released in June 2020.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As v1.3 and the earlier are still used in recent attacks, this article explains the functions of both v1.3 and v1.4.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In v1.4, however, Protocol Buffer (developed by Google) is used for data serialisation instead. In addition, the entire communication is encrypted with TLS1.2.\nFigure 3 shows the comparison of the communication format in v1.3 and v1.4.\n In v1.3, once a client connects to a server, authentication is performed. After that, the main body of data including the commands are exchanged. On the other hand, the authentication is replaced by a TLS handshake in v1.4, and the data exchange begins after that.\n Figure 4 illustrates Quasar\u2019s communication flow between a client and a server.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Quasar possesses its configuration in itself. It is encrypted by the combination of AES and BASE64 encoding.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 7 shows some examples of commands defined in Quasar.\n Table 2 is the list of Quasar Family derived from Quasar which JPCERT/CC confirmed.\n * \u201cClone\u201d in the category refers to variants which uses the entire source code of Quasar with some functions added or modified. \u201cPartially copied\u201d refers to variants created as a new RAT using parts of the original source code.\n Figure 8 shows the comparison of commands embedded in XPCTRA and Quasar.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the comparison above, it is clear that commands in XPCTRA are mostly identical to those in Quasar.\n Figure 9 shows the comparison of the salt value in AsyncRAT and Quasar.\n The salt value in AsyncRAT is identical to that in Quasar.\n As Quasar Family applies some parts of the source code of Quasar, its configuration and communication protocol are also identical.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In some cases, some functions are customised, and as a result, some new configuration and commands are added.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Table 3 lists the differences of Quasar used by each attack group.\n The original Quasar with the default configuration value was used in most cases.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In most parts, the default values of the builder generating Quasar are used as is, except for STARTUPKEY. This way, attacker groups use the default values as per the original to avoid leaving any distinctive evidence.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In some cases, attackers customise Quasar. For example, APT 10 updated some features and used it in some attacks.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The following sections will cover the details of this custom Quasar.\n Quasar used by APT 10 (hereafter \u201ccustom Quasar\u201d) has the following additional values in the configuration.\n Figure 11 shows the comparison of configuration in the custom Quasar and the original Quasar.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This ensures that the custom Quasar is able to communicate with a C2 server even if the target\u2019s environment uses proxy servers.\n While the original Quasar uses CBC mode when encrypting configuration with AES, the custom Quasar uses CFB mode.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "There are some changes to the commands in the custom Quasar. Figure 13 shows the comparison of commands in the custom Quasar and the original Quasar.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In the custom Quasar, new commands DoPlugin and DoPluginResponse are added while some including keylogger are deleted.\n With DoPlugin, new functions can be added by loading additional plugin modules. These new modules can be deleted with DoPluginResponse.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This change enables Quasar to dynamically extend its functions with commands while maintaining Quasar itself as simple as it can be.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This suggests the attacker\u2019s intention to avoid detection by anti-virus software.\n The custom Quasar has a function to create error logs. The file path of the error logs is hardcoded in itself.\n The encryption algorithms for communication with a C2 server also differs in the custom Quasar. While the original Quasar uses AES and QuickLZ, the custom Quasar also uses XOR encoding.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 15 shows the XOR encoding process added to the custom Quasar.\n For AES encryption, the custom Quasar uses CFB mode instead of CBC mode, as seen in the configuration. The encryption methods are as follows:\nJPCERT/CC investigated the activities of Quasar Family C2 servers based on the characteristics discussed above. As of November 2020, 76 IP addresses running as C2 servers have been identified. Figure 16 shows the distribution of Quasar Family C2 servers which were revealed in this investigation.\n Multiple C2 servers are still running in different countries, which indicates its activeness.\n Besides Quasar, other open source RATs are being used in ongoing attack cases [7].",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Attackers are taking advantage of these tools to make attribution difficult and reduce the cost for developing attack infrastructure.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "A tool to support Quasar analysis (compatible with Quasar v1.3 only) is available on GitHub.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "[7] Japan Security Analyst Conference 2020 (Opening Talk): Looking back on the incidents in 2019\nhttps://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_0_JPCERT_en.pdf\nKota Kino is Malware/Forensic Analyst at Incident Response Group, JPCERT/CC since August 2019.\n",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If you wish to make comments or ask questions, please use this form.\n This form is for comments and inquiries.",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "MalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nYAMA-Yet Another Memory Analyzer for malware detection\n DangerousPassword attacks targeting developers\u2019 Windows, macOS, and Linux environments\nHow to Create F.L.I.R.T Signature Using Yara Rules for Static Analysis of ELF Malware\nGobRAT malware written in Go language targeting Linux routers\nMalDoc in PDF - Detection bypass by embedding a malicious Word file into a PDF file \u2013\nHow to Use Volatility 3 Offline",
        "source": "Attack Activities by Quasar Family - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ChessMaster, a campaign targeting Japanese academe, technology enterprises, media outfits, managed service providers, and government agencies, employs malware-laden spear-phishing emails with decoy documents purporting to be legitimate.\n By: Benson Sy, Kawabata Kohei\nJuly 27, 2017\nRead time: 4 min (1144 words)\nFrom gathering intelligence, using the right social engineering lures, and exploiting vulnerabilities to laterally moving within the network, targeted attacks have multifarious tools at their disposal.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "And like in a game of chess, they are the set pieces that make up their modus operandi.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Take for instance the self-named ChessMaster, a campaign targeting Japanese academe, technology enterprises, media outfits, managed service providers, and government agencies. It employs various poisoned pawns in the form of malware-laden spear-phishing emails containing decoy documents.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "And beyond ChessMaster\u2019s endgame and pawns, we also found red flags that allude to its links to APT 10, also known as menuPass, POTASSIUM, Stone Panda, Red Apollo, and CVNX.\n ChessMaster\u2019s name is from pieces of chess/checkers/draughts we found in the resource section of the main backdoor they use against their targets: ChChes, which Trend Micro detects as BKDR_CHCHES.\n What makes the campaign unique is its arsenal of tools and techniques:\nChessMaster and APT 10 Plays the Same Cyberespionage Game\nAPT 10/menuPass is a cyberespionage group whose specific campaign, Operation Cloud Hopper, attacked the intermediaries of their targets of interest\u2014managed service providers (MSPs). Its notoriety stems from their prolific use of multifarious information-stealing backdoors and vulnerability exploits, along with the tenacity of its subterfuges, from spear-phishing emails to attack and infection chains.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "If that sounded familiar, it's because ChessMaster and APT 10 appear to be playing the same cyberespionage game. Here\u2019s a further illustration:\nFigure 1: Similarities in ChessMaster and APT 10\u2019s attack chain\nWe first saw ChChes set its sights on an organization that\u2019s long been a target of APT 10/menuPass.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "As we caught and delved into more ChChes samples in the wild, however, we also saw how they followed the same pattern\u2014exclusive packers, mutual targets, overlapping C&C infrastructure.\n ChChes\u2019 packer, for instance, resembled the one used in menuPass\u2019 old PlugX samples. DNS records also showed that some of their command and control (C&C) servers and domains resolved to the same IP address, or resided in the same subnet.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 2: Comparison of Emdivi and ChChes\nChessMaster\u2019s ChChes also resembles another backdoor, Emdivi, which first made waves in 2014.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Both are second-stage payloads that use the system\u2019s Security Identifier (SID) as encryption key so they execute only in their target\u2019s machine. Their difference lies in complexity\u2014ChChes hides part of the decryption key and payload in registry keys to make it harder to reverse engineer.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "In one instance, we detected PlugX and Emdivi on the same machine. This PlugX variant connected to an APT 10/menuPass-owned domain, but the packer is similar to that used by ChChes.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "While it\u2019s possible it was hit by two different campaigns, further analysis told a different story. Both were compiled on the same date, only several hours apart.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "We detected and acquired the samples the next day, which means both backdoors were delivered to the victim a day after they were compiled.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Figure 3: Overview of the overlaps in ChessMaster and APT 10\u2019s campaigns\nUltimately attacks like ChessMaster\u2019s make pawns out of the systems, networks, devices and their users, all of which hold the organization\u2019s crown jewels.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "This is why enterprises need to be steps ahead of the game: prepare, respond, restore, and learn.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Fine-tune your response\u2014what worked, what didn\u2019t, and what could\u2019ve been done better?\nDefense in depth plays a crucial role especially for the IT/system administrators and information security professionals that watch over them. The network, endpoints, servers, mobile devices, and web/email gateways are the bishops, knights, and rooks that underpin the enterprise\u2019s crown jewels, which is why securing them is important.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Employ behavior monitoring and application control. Deploy firewalls as well intrusion detection and prevention systems. Implement URL categorization, network segmentation, and data categorization.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "ChessMaster\u2019s gambit is spear-phishing, so it\u2019s especially important to filter and safeguard the email gateway.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Additionally, foster a cybersecurity-aware workforce. Seemingly benign icons or decoy documents can still swindle the victim, for instance. More importantly, develop proactive incident response and remediation strategies\u2014threat intelligence helps enterprises prepare and mitigate attacks.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Like in chess, the more you understand your enemy\u2019s moves, the more successful you can be at thwarting them.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "The Indicators of Compromise (IoCs) related to ChessMaster's campaigns is in this appendix.\n This has been presented in the RSA Conference 2017 Asia Pacific & Japan as \u201cChessMaster: A New Campaign Targeting Japan Using the New ChChes Backdoor\u201d on July 27, 2017, in Marina Bay Sands, Singapore. Updated on August 14, 2017, 11:50 PM to include IoCs related to ChessMaster.\n",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    },
    {
        "text": "Try our services free for 30 days\nPrivacy | Legal | Accessibility | Site map\nCopyright \u00a92023 Trend Micro Incorporated.",
        "source": "ChessMaster Makes its Move_ A Look into its Arsenal.html",
        "detection": {},
        "prediction": {}
    }
]